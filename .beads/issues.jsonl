{"id":"sona-02q","title":"Implement writing sample backend with paste, file upload, and URL scraping","description":"## Covers\nUS-009/010/011 (backend) — Adding writing samples via paste, file, and URL.\n\n## Acceptance Criteria\n- GIVEN POST /api/clones/{id}/samples with {content, content_type, source_type: 'paste'} WHEN valid THEN sample is created with word_count and length_category auto-calculated\n- GIVEN POST /api/clones/{id}/samples with file upload WHEN .txt file THEN text is extracted and sample created\n- GIVEN POST /api/clones/{id}/samples with file upload WHEN .docx file THEN text extracted via python-docx\n- GIVEN POST /api/clones/{id}/samples with file upload WHEN .pdf file THEN text extracted via pymupdf\n- GIVEN POST /api/clones/{id}/samples with file upload WHEN unsupported type THEN returns 422\n- GIVEN POST /api/clones/{id}/samples with file upload WHEN file \u003e 50000 words THEN truncates with warning\n- GIVEN POST /api/clones/{id}/samples with {url, source_type: 'url'} WHEN URL is reachable THEN text scraped via httpx+beautifulsoup\n- GIVEN POST /api/clones/{id}/samples with URL WHEN URL fails THEN returns 422 with scraping error\n- GIVEN GET /api/clones/{id}/samples WHEN samples exist THEN returns list ordered by created_at desc\n- GIVEN DELETE /api/clones/{id}/samples/{sample_id} WHEN sample exists THEN deletes and returns 204\n- GIVEN length_category WHEN word_count \u003c 300 THEN 'short'; 300-1000 THEN 'medium'; \u003e 1000 THEN 'long'\n\n## Files to Create/Modify\n- backend/app/services/sample_service.py (create)\n- backend/app/services/scraping_service.py (create)\n- backend/app/services/file_parser.py (create)\n- backend/app/api/samples.py (create)\n- backend/app/api/router.py (modify — add samples router)\n- backend/tests/test_services/test_sample_service.py (create)\n- backend/tests/test_services/test_scraping_service.py (create)\n- backend/tests/test_services/test_file_parser.py (create)\n- backend/tests/test_api/test_samples.py (create)\n\n## TDD Test Cases (Write First)\n1. test_create_sample_from_paste\n2. test_word_count_calculated_correctly\n3. test_length_category_short_medium_long\n4. test_parse_txt_file\n5. test_parse_docx_file\n6. test_parse_pdf_file\n7. test_reject_unsupported_file_type\n8. test_truncate_large_file\n9. test_scrape_url_extracts_text\n10. test_scrape_url_handles_failure\n11. test_list_samples_ordered_by_date\n12. test_delete_sample\n\n## Gotchas\n- PDF parsing is CPU-bound — use run_in_threadpool\n- pytest-httpx for scraping tests\n- File upload via FastAPI UploadFile","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:39:43.036924-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:39:43.036924-07:00","dependencies":[{"issue_id":"sona-02q","depends_on_id":"sona-moc","type":"blocks","created_at":"2026-02-09T14:50:47.382228-07:00","created_by":"Ken Allred"},{"issue_id":"sona-02q","depends_on_id":"sona-mvk","type":"blocks","created_at":"2026-02-09T14:50:52.562912-07:00","created_by":"Ken Allred"},{"issue_id":"sona-02q","depends_on_id":"sona-cco","type":"blocks","created_at":"2026-02-09T14:50:57.750473-07:00","created_by":"Ken Allred"}]}
{"id":"sona-0on","title":"Build file upload and URL scraping flows for samples","description":"## Covers\nUS-010/011 (frontend) — File upload and URL scraping in add sample dialog.\n\n## Acceptance Criteria\n- GIVEN add sample dialog WHEN 'File Upload' tab selected THEN shows drag-and-drop zone\n- GIVEN file dropped WHEN .txt/.docx/.pdf THEN extracts text and shows preview\n- GIVEN file dropped WHEN unsupported type THEN shows error message\n- GIVEN extracted text WHEN preview shown THEN user can edit before adding\n- GIVEN add sample dialog WHEN 'URL' tab selected THEN shows URL input\n- GIVEN URL entered WHEN 'Scrape' clicked THEN shows loading then extracted text preview\n- GIVEN URL scraping WHEN fails THEN shows error with paste fallback suggestion\n- GIVEN preview WHEN 'Add' clicked THEN creates sample with source_type and source_url/filename\n\n## Files to Create/Modify\n- frontend/src/components/samples/FileUploadTab.tsx (create)\n- frontend/src/components/samples/UrlScrapeTab.tsx (create)\n- frontend/src/components/samples/TextPreview.tsx (create)\n- frontend/src/components/samples/AddSampleDialog.tsx (modify — add file/url tabs)\n- frontend/src/components/samples/FileUploadTab.test.tsx (create)\n- frontend/src/components/samples/UrlScrapeTab.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_file_upload_accepts_txt_docx_pdf\n2. test_file_upload_rejects_unsupported\n3. test_file_upload_shows_preview\n4. test_url_input_and_scrape\n5. test_url_scrape_error_message\n6. test_preview_editable_before_add\n7. test_add_from_file_sets_source_type\n\n## Gotchas\n- Use react-dropzone for drag-and-drop\n- File upload sends multipart form data to backend\n- URL scraping calls backend API (not client-side fetch)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:43:01.528204-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:43:01.528204-07:00","dependencies":[{"issue_id":"sona-0on","depends_on_id":"sona-di2","type":"blocks","created_at":"2026-02-09T14:54:47.381175-07:00","created_by":"Ken Allred"}]}
{"id":"sona-0rn","title":"Implement design system: shadcn/ui setup, color tokens, dark mode, showcase page","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T14:41:30.494279-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T15:17:27.098862-07:00","closed_at":"2026-02-08T15:17:27.098862-07:00","close_reason":"Closed"}
{"id":"sona-0ya","title":"Build clone creation form and detail page shell with 3-tab layout","description":"## Covers\nUS-008/015 (frontend) — Clone creation and detail page structure.\n\n## Acceptance Criteria\n- GIVEN /clones/new WHEN loaded THEN shows form with: name (required), description, tags\n- GIVEN the form WHEN submitted with valid data THEN creates clone and navigates to /clones/{id}\n- GIVEN /clones/{id} WHEN loaded THEN shows: header (name, type badge, confidence badge, actions), 3 tabs (Samples, Voice DNA, Generated Content)\n- GIVEN clone header WHEN name is clicked THEN it becomes editable inline\n- GIVEN clone header WHEN 'Delete' clicked THEN shows confirmation dialog\n- GIVEN tabs WHEN 'Samples' clicked THEN shows sample list (placeholder)\n- GIVEN tabs WHEN 'Voice DNA' clicked THEN shows DNA display (placeholder)\n- GIVEN tabs WHEN 'Generated Content' clicked THEN shows filtered content list (placeholder)\n\n## Files to Create/Modify\n- frontend/src/pages/clones/CreateClonePage.tsx (create)\n- frontend/src/pages/clones/CloneDetailPage.tsx (create)\n- frontend/src/components/clones/CloneForm.tsx (create)\n- frontend/src/components/clones/CloneHeader.tsx (create)\n- frontend/src/hooks/use-clones.ts (create — useClones, useClone, useCreateClone, useUpdateClone, useDeleteClone)\n- frontend/src/test/handlers/clones.ts (modify)\n- frontend/src/pages/clones/CreateClonePage.test.tsx (create)\n- frontend/src/pages/clones/CloneDetailPage.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_create_form_requires_name\n2. test_create_form_submits_valid_data\n3. test_detail_page_shows_clone_info\n4. test_detail_page_has_three_tabs\n5. test_inline_name_edit\n6. test_delete_confirmation_dialog\n7. test_navigates_after_create\n\n## Gotchas\n- Use React Hook Form + Zod for create form\n- Tags input: allow freeform tags (comma-separated or enter to add)\n- Badge colors per confidence thresholds from constants","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:42:51.038299-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:42:51.038299-07:00","dependencies":[{"issue_id":"sona-0ya","depends_on_id":"sona-bf7","type":"blocks","created_at":"2026-02-09T14:54:10.790194-07:00","created_by":"Ken Allred"},{"issue_id":"sona-0ya","depends_on_id":"sona-w7n","type":"blocks","created_at":"2026-02-09T14:54:16.022649-07:00","created_by":"Ken Allred"},{"issue_id":"sona-0ya","depends_on_id":"sona-fhi","type":"blocks","created_at":"2026-02-09T14:54:21.257872-07:00","created_by":"Ken Allred"},{"issue_id":"sona-0ya","depends_on_id":"sona-ad6","type":"blocks","created_at":"2026-02-09T14:54:26.480898-07:00","created_by":"Ken Allred"},{"issue_id":"sona-0ya","depends_on_id":"sona-8d7","type":"blocks","created_at":"2026-02-09T14:54:31.704002-07:00","created_by":"Ken Allred"}]}
{"id":"sona-0zz","title":"Implement DNA versioning with 10-version retention and revert","description":"## Covers\nUS-019 (backend) — DNA version history with revert and pruning.\n\n## Acceptance Criteria\n- GIVEN a clone WHEN DNA is analyzed THEN version_number increments from last version\n- GIVEN PUT /api/clones/{id}/dna with manual edits WHEN valid THEN creates new version with trigger='manual_edit'\n- GIVEN POST /api/clones/{id}/dna/revert/{version} WHEN version exists THEN creates new version copying old DNA with trigger='revert'\n- GIVEN a clone with 10 DNA versions WHEN new version is created THEN oldest version is pruned\n- GIVEN a clone with \u003c 10 versions WHEN new version is created THEN no pruning occurs\n- GIVEN version history WHEN listed THEN each version shows: version_number, trigger, model_used, created_at\n\n## Files to Create/Modify\n- backend/app/services/dna_service.py (modify — add revert, manual_edit, pruning)\n- backend/tests/test_services/test_dna_service.py (modify — add version tests)\n\n## TDD Test Cases (Write First)\n1. test_version_number_increments\n2. test_manual_edit_creates_version\n3. test_revert_copies_old_dna\n4. test_revert_creates_new_version_not_delete\n5. test_prune_oldest_at_11_versions\n6. test_no_prune_under_10_versions\n\n## Gotchas\n- Revert is non-destructive — creates new version\n- Pruning: delete WHERE version_number = min(versions) for clone","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:14.463244-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:14.463244-07:00","dependencies":[{"issue_id":"sona-0zz","depends_on_id":"sona-onf","type":"blocks","created_at":"2026-02-09T14:52:00.23122-07:00","created_by":"Ken Allred"}]}
{"id":"sona-1a4","title":"Build clone list page with cards, search, and type filter","description":"## Covers\nUS-014 — Clone list page with card grid.\n\n## Acceptance Criteria\n- GIVEN /clones WHEN clones exist THEN shows card grid with: name, avatar/initials, confidence badge, type badge, sample count, last updated\n- GIVEN /clones WHEN search input typed THEN filters clones by name\n- GIVEN /clones WHEN type filter selected (All/Original/Merged/Demo) THEN filters by type\n- GIVEN 'Hide Demo Clones' toggle WHEN enabled THEN demo clones are hidden (persisted in local storage)\n- GIVEN a clone card WHEN clicked THEN navigates to /clones/{id}\n- GIVEN no clones WHEN page loads THEN shows first-run empty state (from task 29)\n- GIVEN clone cards WHEN sorted THEN ordered by last updated (most recent first)\n\n## Files to Create/Modify\n- frontend/src/pages/clones/ClonesPage.tsx (modify — full implementation)\n- frontend/src/components/clones/CloneCard.tsx (create)\n- frontend/src/components/clones/CloneListFilters.tsx (create)\n- frontend/src/stores/ui-store.ts (modify — add hideDemoClones)\n- frontend/src/pages/clones/ClonesPage.test.tsx (modify)\n- frontend/src/components/clones/CloneCard.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_clone_cards\n2. test_search_filters_by_name\n3. test_type_filter_works\n4. test_hide_demo_toggle_persisted\n5. test_card_navigates_to_detail\n6. test_empty_state_when_no_clones\n7. test_sorted_by_last_updated\n\n## Gotchas\n- Card grid: responsive — 1 col mobile, 2 col tablet, 3 col desktop\n- Avatar: colored circle with initials (no actual image upload in v1)\n- Type badge: Original (default), Merged (blue), Demo (purple)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:43:12.023263-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:43:12.023263-07:00","dependencies":[{"issue_id":"sona-1a4","depends_on_id":"sona-0ya","type":"blocks","created_at":"2026-02-09T14:55:02.965162-07:00","created_by":"Ken Allred"},{"issue_id":"sona-1a4","depends_on_id":"sona-tw8","type":"blocks","created_at":"2026-02-09T14:55:08.194704-07:00","created_by":"Ken Allred"},{"issue_id":"sona-1a4","depends_on_id":"sona-4rb","type":"blocks","created_at":"2026-02-09T14:55:13.430741-07:00","created_by":"Ken Allred"}]}
{"id":"sona-1ce","title":"Build sample gap heatmap visualization","description":"## Covers\nUS-052 — Visual representation of sample coverage gaps.\n\n## Acceptance Criteria\n- GIVEN Samples tab WHEN heatmap shown THEN displays grid of content types vs length categories\n- GIVEN a cell WHEN samples exist for that combination THEN cell is colored (intensity by count)\n- GIVEN a cell WHEN no samples exist THEN cell is empty/gray\n- GIVEN gaps WHEN identified THEN recommendations suggest specific content types to add\n\n## Files to Create/Modify\n- frontend/src/components/samples/GapHeatmap.tsx (create)\n- frontend/src/components/samples/GapHeatmap.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_grid\n2. test_colored_cells_for_existing_samples\n3. test_empty_cells_for_gaps\n4. test_recommendations_for_gaps\n\n## Gotchas\n- Grid: content types (rows) x length categories (columns: short, medium, long)\n- Color intensity based on sample count in that cell","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:21.068698-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:21.068698-07:00","dependencies":[{"issue_id":"sona-1ce","depends_on_id":"sona-di2","type":"blocks","created_at":"2026-02-09T14:59:13.842617-07:00","created_by":"Ken Allred"}]}
{"id":"sona-1d9","title":"Implement A/B content variants with comparison view","description":"## Covers\nUS-045 — Generate 3 content variants for comparison.\n\n## Acceptance Criteria\n- GIVEN 'Generate Variants' button WHEN clicked THEN generates 3 variations per platform with temperature variation\n- GIVEN variants WHEN displayed THEN shows horizontal comparison: side by side on wide screens\n- GIVEN each variant WHEN shown THEN displays: content text, word count, authenticity score\n- GIVEN a variant WHEN selected THEN becomes the primary content\n- GIVEN unselected variants WHEN dismissed THEN not saved to library\n- GIVEN cost estimate WHEN shown upfront THEN indicates 3x standard generation cost\n\n## Files to Create/Modify\n- frontend/src/components/content/VariantComparison.tsx (create)\n- backend/app/services/content_service.py (modify — add generate_variants)\n- backend/app/api/content.py (modify — add variants endpoint)\n- frontend/src/components/content/VariantComparison.test.tsx (create)\n- backend/tests/test_services/test_content_service.py (modify)\n\n## TDD Test Cases (Write First)\n1. test_generate_3_variants\n2. test_variants_use_temperature_variation\n3. test_variant_selection\n4. test_unselected_variants_not_saved\n5. test_cost_estimate_3x\n\n## Gotchas\n- Temperature variation: 0.5, 0.7, 0.9 (or similar)\n- Each variant is independent — parallel generation","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:47:54.975907-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:47:54.975907-07:00","dependencies":[{"issue_id":"sona-1d9","depends_on_id":"sona-6c9","type":"blocks","created_at":"2026-02-09T14:58:37.243093-07:00","created_by":"Ken Allred"}]}
{"id":"sona-1sb","title":"Implement generation presets CRUD backend and UI","description":"## Covers\nUS-027 — Generation presets for reusable settings.\n\n## Acceptance Criteria\n- GIVEN POST /api/presets with {name, properties} WHEN valid THEN creates preset\n- GIVEN GET /api/presets WHEN presets exist THEN returns list\n- GIVEN PUT /api/presets/{id} WHEN updated THEN saves changes\n- GIVEN DELETE /api/presets/{id} WHEN deleted THEN removes preset\n- GIVEN properties form WHEN 'Save as Preset' clicked THEN saves current properties as preset\n- GIVEN properties form WHEN preset loaded from dropdown THEN fills all fields\n- GIVEN /settings/presets WHEN loaded THEN shows preset management UI\n\n## Files to Create/Modify\n- backend/app/services/preset_service.py (create)\n- backend/app/api/presets.py (create)\n- frontend/src/pages/settings/PresetsPage.tsx (create)\n- frontend/src/components/content/PresetSelector.tsx (create)\n- backend/tests/test_services/test_preset_service.py (create)\n- backend/tests/test_api/test_presets.py (create)\n- frontend/src/pages/settings/PresetsPage.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_create_preset\n2. test_list_presets\n3. test_update_preset\n4. test_delete_preset\n5. test_load_preset_fills_form\n6. test_save_as_preset_from_form\n\n## Gotchas\n- Preset stores properties JSON, NOT clone or input\n- Preset name must be unique","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:35.403065-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:35.403065-07:00","dependencies":[{"issue_id":"sona-1sb","depends_on_id":"sona-bs1","type":"blocks","created_at":"2026-02-09T14:58:11.088816-07:00","created_by":"Ken Allred"}]}
{"id":"sona-2qg","title":"Fix sona-6c9 acceptance criteria for US-024 thread splitting","status":"in_progress","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-09T16:16:06.340331-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T16:16:14.663703-07:00"}
{"id":"sona-3ca","title":"Implement auto-detect content type heuristics","description":"## Covers\nUS-012 — Content type auto-detection for writing samples.\n\n## Acceptance Criteria\n- GIVEN text \u003c 300 chars with hashtags WHEN auto-detected THEN returns 'tweet'\n- GIVEN text with greeting/sign-off patterns WHEN auto-detected THEN returns 'email'\n- GIVEN text \u003e 500 words with markdown headings WHEN auto-detected THEN returns 'blog_post'\n- GIVEN text 300-3000 chars without headings WHEN auto-detected THEN returns 'linkedin_post'\n- GIVEN text with multiple sections/headings + greeting WHEN auto-detected THEN returns 'newsletter'\n- GIVEN text with numbered items/sequential short segments WHEN auto-detected THEN returns 'thread'\n- GIVEN unclassifiable text WHEN auto-detected THEN returns 'other'\n- GIVEN auto-detected type WHEN displayed THEN shows '(detected)' label next to content type\n- GIVEN auto-detected type WHEN user changes dropdown THEN overrides detection\n\n## Files to Create/Modify\n- backend/app/services/content_type_detector.py (create)\n- backend/tests/test_services/test_content_type_detector.py (create)\n\n## TDD Test Cases (Write First)\n1. test_detect_tweet_short_with_hashtags\n2. test_detect_email_with_greeting\n3. test_detect_blog_post_long_with_headings\n4. test_detect_linkedin_medium_no_headings\n5. test_detect_newsletter_sections_greeting\n6. test_detect_thread_numbered\n7. test_detect_other_fallback\n8. test_url_import_also_auto_detects\n\n## Gotchas\n- No LLM needed — pure heuristics\n- Heuristics should be ordered by specificity (most specific first)\n- Edge cases: short text with greeting = email, not tweet","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:14.54957-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:14.54957-07:00","dependencies":[{"issue_id":"sona-3ca","depends_on_id":"sona-di2","type":"blocks","created_at":"2026-02-09T14:57:29.250193-07:00","created_by":"Ken Allred"}]}
{"id":"sona-3dp","title":"Add implementation plan and task graph","description":"Create docs/implementation-plan.md architecture reference and 65 Beads tasks with full dependency graph covering all 58 user stories.","status":"closed","priority":0,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-09T15:54:18.557368-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T15:56:45.954675-07:00","closed_at":"2026-02-09T15:56:45.954675-07:00","close_reason":"Closed"}
{"id":"sona-4e8","title":"Build content version history with preview and restore","description":"## Covers\nUS-035 (frontend) — Content version history navigation.\n\n## Acceptance Criteria\n- GIVEN content detail WHEN 'History' tab clicked THEN shows version list\n- GIVEN each version WHEN displayed THEN shows: version number, timestamp, trigger type, word count delta\n- GIVEN a version WHEN clicked THEN shows read-only preview\n- GIVEN a version WHEN 'Restore' clicked THEN creates new version with old content\n- GIVEN word count delta WHEN displayed THEN shows '+42 words' or '-15 words'\n\n## Files to Create/Modify\n- frontend/src/components/content/ContentVersionHistory.tsx (create)\n- frontend/src/components/shared/VersionHistory.tsx (modify if needed)\n- frontend/src/components/content/ContentVersionHistory.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_shows_version_list\n2. test_version_shows_word_count_delta\n3. test_click_shows_preview\n4. test_restore_creates_new_version\n5. test_trigger_type_badges\n\n## Gotchas\n- Word count delta calculated from consecutive versions\n- Reuses VersionHistory shared component pattern","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:44:57.366365-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:44:57.366365-07:00","dependencies":[{"issue_id":"sona-4e8","depends_on_id":"sona-6c9","type":"blocks","created_at":"2026-02-09T14:56:57.860497-07:00","created_by":"Ken Allred"}]}
{"id":"sona-4ep","title":"Implement advanced content editing: feedback-driven and partial regen","description":"## Covers\nUS-025 (full) — Feedback-driven and partial regeneration.\n\n## Acceptance Criteria\n- GIVEN review panel WHEN feedback input shown THEN user can type specific feedback ('make it shorter', 'more humor')\n- GIVEN feedback submitted WHEN sent to LLM THEN includes feedback + current content + DNA for targeted improvement\n- GIVEN review panel WHEN text is selected THEN 'Regenerate Selection' button appears\n- GIVEN partial regeneration WHEN triggered THEN only selected text is regenerated with surrounding context\n- GIVEN any edit/regeneration WHEN completed THEN creates new ContentVersion\n\n## Files to Create/Modify\n- frontend/src/components/content/FeedbackInput.tsx (create)\n- frontend/src/components/content/ReviewPanel.tsx (modify — add feedback and partial regen)\n- backend/app/services/content_service.py (modify — add feedback_regenerate and partial_regenerate)\n- backend/app/api/content.py (modify — add endpoints)\n- frontend/src/components/content/FeedbackInput.test.tsx (create)\n- backend/tests/test_services/test_content_service.py (modify)\n\n## TDD Test Cases (Write First)\n1. test_feedback_regen_includes_feedback_in_prompt\n2. test_feedback_regen_includes_current_content\n3. test_partial_regen_only_replaces_selection\n4. test_partial_regen_preserves_surrounding\n5. test_each_edit_creates_version\n\n## Gotchas\n- Partial regen is best-effort — seams may appear\n- Text selection tracking in textarea/contentEditable","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:45.837928-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:45.837928-07:00","dependencies":[{"issue_id":"sona-4ep","depends_on_id":"sona-6c9","type":"blocks","created_at":"2026-02-09T14:58:21.552722-07:00","created_by":"Ken Allred"}]}
{"id":"sona-4g8","title":"Build content library page with data table and virtual scrolling","description":"## Covers\nUS-036 (frontend) — Content library data table.\n\n## Acceptance Criteria\n- GIVEN /library WHEN content exists THEN shows data table with: content preview, clone name, platform, status, authenticity score, date\n- GIVEN data table WHEN rendered THEN uses @tanstack/react-table with sortable columns\n- GIVEN 1000+ items WHEN scrolling THEN uses @tanstack/react-virtual for performance\n- GIVEN a row WHEN clicked THEN opens content detail panel or navigates to /create/{id}\n- GIVEN no content WHEN page loads THEN shows empty state with link to generator\n- GIVEN table columns WHEN configured THEN status shows colored badge, score shows colored badge\n\n## Files to Create/Modify\n- frontend/src/pages/library/LibraryPage.tsx (modify — full implementation)\n- frontend/src/components/content/ContentTable.tsx (create)\n- frontend/src/components/content/ContentRow.tsx (create)\n- frontend/src/hooks/use-content.ts (modify — add useContentList)\n- frontend/src/pages/library/LibraryPage.test.tsx (create)\n- frontend/src/components/content/ContentTable.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_data_table\n2. test_sortable_columns\n3. test_row_click_opens_detail\n4. test_empty_state\n5. test_status_badge_colors\n6. test_score_badge_colors\n\n## Gotchas\n- Virtual scrolling only needed for large lists — graceful fallback for small lists\n- Content preview: first 100 chars of content_current\n- Status badge colors match PRD: draft=gray, review=yellow, approved=blue, published=green, archived=muted","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:43:27.763839-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:43:27.763839-07:00","dependencies":[{"issue_id":"sona-4g8","depends_on_id":"sona-bf7","type":"blocks","created_at":"2026-02-09T14:55:55.28221-07:00","created_by":"Ken Allred"},{"issue_id":"sona-4g8","depends_on_id":"sona-w7n","type":"blocks","created_at":"2026-02-09T14:56:00.508874-07:00","created_by":"Ken Allred"},{"issue_id":"sona-4g8","depends_on_id":"sona-fhi","type":"blocks","created_at":"2026-02-09T14:56:05.650148-07:00","created_by":"Ken Allred"},{"issue_id":"sona-4g8","depends_on_id":"sona-ad6","type":"blocks","created_at":"2026-02-09T14:56:10.874795-07:00","created_by":"Ken Allred"},{"issue_id":"sona-4g8","depends_on_id":"sona-eox","type":"blocks","created_at":"2026-02-09T14:56:16.110588-07:00","created_by":"Ken Allred"}]}
{"id":"sona-4kp","title":"Seed demo voice clones with pre-analyzed DNA and samples","description":"## Covers\nUS-006 — Demo clones for first-run experience.\n\n## Acceptance Criteria\n- GIVEN first startup WHEN database is empty THEN 3 demo clones are created: Professional Blogger, Casual Social, Technical Writer\n- GIVEN each demo clone WHEN seeded THEN it has: 3-5 writing samples, pre-analyzed Voice DNA, prominence_scores, confidence_score 80+, is_demo=true\n- GIVEN demo clones WHEN displayed THEN they show 'Demo' badge\n- GIVEN demo clones WHEN user tries to delete THEN operation is rejected\n- GIVEN demo clones WHEN user tries to add samples THEN operation is rejected\n- GIVEN seed function WHEN run on existing database THEN skips if demo clones already exist (idempotent)\n\n## Files to Create/Modify\n- backend/app/seed.py (modify — add seed_demo_clones function)\n- backend/app/main.py (modify — call seed_demo_clones in lifespan)\n- backend/tests/test_seed.py (modify — add demo clone tests)\n\n## TDD Test Cases (Write First)\n1. test_seed_creates_three_demo_clones\n2. test_seed_idempotent\n3. test_demo_clones_have_samples\n4. test_demo_clones_have_dna\n5. test_demo_clones_confidence_above_80\n6. test_demo_clone_is_demo_flag_true\n\n## Gotchas\n- Writing sample content should be realistic and diverse\n- DNA must be a valid, complete structure (all 9 categories)\n- Prominence scores should be varied (not all 50s)\n- Seed after methodology defaults (demo DNA references methodology)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:45.995919-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:45.995919-07:00","dependencies":[{"issue_id":"sona-4kp","depends_on_id":"sona-dfe","type":"blocks","created_at":"2026-02-09T14:52:57.616818-07:00","created_by":"Ken Allred"},{"issue_id":"sona-4kp","depends_on_id":"sona-02q","type":"blocks","created_at":"2026-02-09T14:53:02.836-07:00","created_by":"Ken Allred"}]}
{"id":"sona-4rb","title":"Build first-run flow with empty states and RequiresProvider guard","description":"## Covers\nUS-007 — First-run experience and provider guard.\n\n## Acceptance Criteria\n- GIVEN no API keys configured WHEN /clones loads THEN shows welcome empty state with: app logo, tagline, 'Set Up AI Provider' CTA, 'Explore Demo Voices' CTA\n- GIVEN no provider configured WHEN AI action attempted (Analyze DNA, Generate) THEN shows inline message: 'No AI provider configured. Go to Settings' with link\n- GIVEN provider is configured WHEN /clones loads THEN shows demo clones + 'Create Your First Clone' CTA\n- GIVEN provider is configured WHEN user returns to /clones after setup THEN shows success toast\n- GIVEN RequiresProvider guard component WHEN wrapping AI actions THEN checks provider status and shows message if not configured\n\n## Files to Create/Modify\n- frontend/src/components/shared/RequiresProvider.tsx (create)\n- frontend/src/components/shared/EmptyState.tsx (create)\n- frontend/src/pages/clones/ClonesPage.tsx (modify — add empty states)\n- frontend/src/hooks/use-providers.ts (modify — add useHasProvider hook)\n- frontend/src/components/shared/RequiresProvider.test.tsx (create)\n- frontend/src/pages/clones/ClonesPage.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_welcome_state_when_no_provider\n2. test_setup_cta_links_to_providers\n3. test_requires_provider_shows_message_when_none\n4. test_requires_provider_renders_children_when_configured\n5. test_demo_clones_visible_without_provider\n\n## Gotchas\n- EmptyState is a shared component — used across clones, content, library\n- RequiresProvider wraps action buttons, not whole pages\n- Demo clones are visible even without provider (browsing only)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:42:45.787118-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:42:45.787118-07:00","dependencies":[{"issue_id":"sona-4rb","depends_on_id":"sona-8f5","type":"blocks","created_at":"2026-02-09T14:54:00.343015-07:00","created_by":"Ken Allred"},{"issue_id":"sona-4rb","depends_on_id":"sona-4kp","type":"blocks","created_at":"2026-02-09T14:54:05.565187-07:00","created_by":"Ken Allred"}]}
{"id":"sona-4ux","title":"Create tech-stack.md with definitive technology decisions","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T09:17:11.452502-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T09:21:47.732586-07:00","closed_at":"2026-02-08T09:21:47.732586-07:00","close_reason":"Closed"}
{"id":"sona-4wz","title":"Implement OpenAI LLM provider","description":"## Covers\nUS-001 (OpenAI) — OpenAI provider implementation.\n\n## Acceptance Criteria\n- GIVEN OpenAIProvider WHEN complete() is called THEN it calls openai.AsyncOpenAI.chat.completions.create and returns the message content\n- GIVEN OpenAIProvider WHEN stream() is called THEN it yields chunks from openai streaming response\n- GIVEN OpenAIProvider WHEN count_tokens() is called THEN it returns an estimated token count\n- GIVEN OpenAIProvider WHEN test_connection() is called THEN it sends a minimal API call and returns True on success\n- GIVEN an openai.AuthenticationError WHEN caught THEN it raises LLMAuthError\n- GIVEN an openai.RateLimitError WHEN caught THEN it raises LLMRateLimitError\n- GIVEN an openai.APIConnectionError WHEN caught THEN it raises LLMNetworkError\n\n## Files to Create/Modify\n- backend/app/llm/openai.py (create)\n\n## TDD Test Cases (Write First)\n1. test_complete_returns_response_text\n2. test_complete_passes_model_and_temperature\n3. test_stream_yields_chunks\n4. test_test_connection_returns_true_on_success\n5. test_auth_error_maps_to_llm_auth_error\n6. test_rate_limit_maps_to_llm_rate_limit_error\n7. test_network_error_maps_to_llm_network_error\n\n## Gotchas\n- Always mock AsyncOpenAI in tests — never make real API calls\n- Use openai.AsyncOpenAI (async client)\n- Token counting: use tiktoken if available, else approximate (1 token ≈ 4 chars)","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:36:58.818262-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:36:58.818262-07:00","dependencies":[{"issue_id":"sona-4wz","depends_on_id":"sona-535","type":"blocks","created_at":"2026-02-09T14:50:11.065669-07:00","created_by":"Ken Allred"}]}
{"id":"sona-535","title":"Implement LLM provider protocol, registry, and error types","description":"## Covers\nUS-001 (abstraction) — LLM provider protocol and factory.\n\n## Acceptance Criteria\n- GIVEN LLMProvider protocol in llm/base.py WHEN a class implements it THEN it must have complete(), stream(), count_tokens(), and test_connection() methods\n- GIVEN llm/registry.py WHEN get_provider('openai') is called with a configured key THEN it returns an OpenAI provider instance\n- GIVEN llm/registry.py WHEN get_provider('openai') is called without a configured key THEN it raises ProviderNotConfiguredError\n- GIVEN llm/registry.py WHEN get_default_provider() is called THEN it returns the provider matching DEFAULT_LLM_PROVIDER env var\n- GIVEN a provider call fails with auth error WHEN caught THEN it raises LLMAuthError (no retry)\n- GIVEN a provider call fails with rate limit WHEN caught THEN it retries up to 2 times with exponential backoff (1s, 3s)\n- GIVEN a provider call fails with network error WHEN caught THEN it retries up to 2 times with exponential backoff\n- GIVEN llm/prompts.py WHEN build_dna_analysis_prompt is called THEN it returns a formatted prompt combining samples and methodology instructions\n\n## Files to Create/Modify\n- backend/app/llm/__init__.py (create)\n- backend/app/llm/base.py (create — LLMProvider protocol, LLMError types)\n- backend/app/llm/registry.py (create — ProviderRegistry)\n- backend/app/llm/prompts.py (create — prompt template functions)\n- backend/app/exceptions.py (modify — add LLM error classes)\n- backend/app/config.py (modify — add DEFAULT_LLM_PROVIDER, model settings)\n\n## TDD Test Cases (Write First)\n1. test_registry_returns_provider_for_configured_key\n2. test_registry_raises_when_no_key_configured\n3. test_registry_returns_default_provider\n4. test_retry_on_rate_limit_succeeds_after_retry\n5. test_no_retry_on_auth_error\n6. test_retry_exhausted_raises_original_error\n7. test_build_dna_analysis_prompt_includes_samples\n8. test_build_generation_prompt_includes_dna_and_platform\n\n## Gotchas\n- Protocol class, not ABC — allows structural subtyping\n- Registry reads from Settings (pydantic-settings) — inject via constructor for testability\n- Retry logic lives in a shared decorator/wrapper, not in each provider\n- prompts.py is frequently edited — keep templates as functions, not constants","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:36:53.60848-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:36:53.60848-07:00","dependencies":[{"issue_id":"sona-535","depends_on_id":"sona-ega","type":"blocks","created_at":"2026-02-09T14:50:05.886695-07:00","created_by":"Ken Allred"}]}
{"id":"sona-5mw","title":"Configure multi-agent git workflow with worktrees, CI, and documentation","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T09:34:28.93475-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T09:39:32.938917-07:00","closed_at":"2026-02-08T09:39:32.938917-07:00","close_reason":"Closed"}
{"id":"sona-5qk","title":"Update PRD with gap analysis fixes and innovation enhancements","description":"Apply gap fixes and innovation enhancements to docs/plan.md","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T08:46:38.200538-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T08:55:41.202029-07:00","closed_at":"2026-02-08T08:55:41.202029-07:00","close_reason":"Closed"}
{"id":"sona-665","title":"Create project-structure.md and scaffold directory structure","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T11:25:16.474187-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T11:29:59.126465-07:00","closed_at":"2026-02-08T11:29:59.126465-07:00","close_reason":"Closed"}
{"id":"sona-6c9","title":"Build content generation flow, review panel, and platform preview","description":"## Covers\nUS-023/024/025/026 (frontend) — Generation execution and content review.\n\n## Acceptance Criteria\n- GIVEN 'Generate' clicked WHEN processing THEN shows loading indicator with progress per platform\n- GIVEN generation complete WHEN content returned THEN shows in review panel with tabs per platform\n- GIVEN review panel per platform WHEN displayed THEN shows: editable content, word count, char count, platform limit indicator, authenticity score\n- GIVEN platform limit WHEN content under limit THEN green indicator\n- GIVEN platform limit WHEN content \u003e80% of limit THEN yellow warning indicator with progress bar\n- GIVEN platform limit WHEN content over limit THEN red indicator with char count\n- GIVEN Twitter content WHEN char count \u003e280 THEN shows 'Convert to thread?' button\n- GIVEN 'Convert to thread?' clicked WHEN content \u003e280 chars THEN splits on sentence boundaries with 1/N numbering via splitIntoThread()\n- GIVEN platform preview WHEN displayed THEN shows platform-specific formatting hints (hashtag highlighting for Twitter, section headers for blog)\n- GIVEN platform constants WHEN imported from frontend/src/lib/platforms.ts THEN includes char limits for all platforms per PRD 4.6 (Twitter 280, LinkedIn 3000, Facebook 63206, Instagram 2200, SMS 160)\n- GIVEN review panel WHEN 'Save to Library' clicked THEN saves as draft and shows success toast\n- GIVEN review panel WHEN content edited inline THEN tracks changes\n- GIVEN review panel WHEN 'Regenerate' clicked THEN regenerates content for that platform\n\n## Files to Create/Modify\n- frontend/src/components/content/GenerationProgress.tsx (create)\n- frontend/src/components/content/ReviewPanel.tsx (create)\n- frontend/src/components/content/PlatformPreview.tsx (create)\n- frontend/src/components/content/PlatformTabs.tsx (create)\n- frontend/src/lib/platforms.ts (create — platform constants, splitIntoThread utility)\n- frontend/src/hooks/use-content.ts (modify — add useGenerateContent, useSaveContent)\n- frontend/src/components/content/ReviewPanel.test.tsx (create)\n- frontend/src/components/content/PlatformPreview.test.tsx (create)\n- frontend/src/lib/platforms.test.ts (create — platform constants and thread splitting tests)\n\n## TDD Test Cases (Write First)\n1. test_loading_indicator_during_generation\n2. test_review_shows_platform_tabs\n3. test_review_shows_word_and_char_count\n4. test_platform_limit_green_when_under\n5. test_platform_limit_red_when_over\n6. test_save_to_library\n7. test_inline_edit_tracks_changes\n8. test_regenerate_per_platform\n9. test_platform_limit_yellow_when_approaching_80_percent\n10. test_twitter_thread_split_button_appears_when_over_280\n11. test_thread_splitting_respects_sentence_boundaries\n12. test_thread_numbering_format\n13. test_platform_constants_match_prd_limits\n\n## Gotchas\n- Platform limits from frontend/src/lib/platforms.ts constants (not types/platforms.ts)\n- splitIntoThread() splits on sentence boundaries (period + space), adds 1/N numbering, each chunk ≤280 chars\n- Inline editing uses contentEditable or textarea\n- Save creates Content + initial ContentVersion on backend\n- Yellow warning threshold is 80% of platform limit (not configurable in v1)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:43:22.521213-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T16:12:27.038878-07:00","dependencies":[{"issue_id":"sona-6c9","depends_on_id":"sona-bs1","type":"blocks","created_at":"2026-02-09T14:55:44.827754-07:00","created_by":"Ken Allred"},{"issue_id":"sona-6c9","depends_on_id":"sona-d29","type":"blocks","created_at":"2026-02-09T14:55:50.050318-07:00","created_by":"Ken Allred"}]}
{"id":"sona-7de","title":"Build content import to library with paste and file upload","description":"## Covers\nUS-058 — Import existing content into library.\n\n## Acceptance Criteria\n- GIVEN library page WHEN 'Import' clicked THEN shows dialog with paste and file upload options\n- GIVEN paste import WHEN text pasted THEN creates content record as draft with source 'import'\n- GIVEN file import WHEN .txt uploaded THEN creates content record\n- GIVEN imported content WHEN saved THEN user can assign clone, platform, tags\n- GIVEN imported content WHEN in library THEN appears with 'Imported' badge\n\n## Files to Create/Modify\n- frontend/src/components/content/ImportDialog.tsx (create)\n- backend/app/api/content.py (modify — add import endpoint)\n- backend/app/services/content_service.py (modify — add import method)\n- frontend/src/components/content/ImportDialog.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_import_paste_creates_content\n2. test_import_file_creates_content\n3. test_import_assigns_metadata\n4. test_imported_content_has_badge\n\n## Gotchas\n- Imported content has no authenticity score initially\n- Clone assignment is optional\n- Reuses file parsing from sample service","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:51.038985-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:51.038985-07:00","dependencies":[{"issue_id":"sona-7de","depends_on_id":"sona-4g8","type":"blocks","created_at":"2026-02-09T14:58:26.786193-07:00","created_by":"Ken Allred"},{"issue_id":"sona-7de","depends_on_id":"sona-02q","type":"blocks","created_at":"2026-02-09T14:58:32.015636-07:00","created_by":"Ken Allred"}]}
{"id":"sona-7tf","title":"Add Claude Code permission settings for project","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T07:44:14.112295-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T07:44:36.801494-07:00","closed_at":"2026-02-08T07:44:36.801494-07:00","close_reason":"Closed"}
{"id":"sona-7yg","title":"Build data transparency page and database backup/restore","description":"## Covers\nUS-054/057 — Data transparency and backup functionality.\n\n## Acceptance Criteria\n- GIVEN /settings/data WHEN loaded THEN shows: database location, database size, clone count, content count, sample count\n- GIVEN 'Backup' button WHEN clicked THEN copies sona.db to user-chosen location\n- GIVEN 'Restore' button WHEN clicked THEN replaces sona.db from uploaded file (with confirmation)\n- GIVEN data page WHEN viewed THEN shows what data is stored locally vs sent to LLM providers\n\n## Files to Create/Modify\n- frontend/src/pages/settings/DataPage.tsx (create)\n- backend/app/api/system.py (create — database stats and backup endpoints)\n- frontend/src/pages/settings/DataPage.test.tsx (create)\n- backend/tests/test_api/test_system.py (create)\n\n## TDD Test Cases (Write First)\n1. test_shows_database_stats\n2. test_backup_creates_copy\n3. test_restore_replaces_database\n4. test_data_transparency_info\n\n## Gotchas\n- Backup is just a file copy of data/sona.db\n- Restore requires app restart\n- Data transparency: writing samples and prompts are sent to LLM providers","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:41.90703-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:41.90703-07:00","dependencies":[{"issue_id":"sona-7yg","depends_on_id":"sona-bf7","type":"blocks","created_at":"2026-02-09T14:59:39.978739-07:00","created_by":"Ken Allred"}]}
{"id":"sona-879","title":"Implement confidence scoring algorithm (5 components)","description":"## Covers\nUS-013 (backend) — Deterministic confidence score calculation.\n\n## Acceptance Criteria\n- GIVEN a clone with no samples WHEN confidence calculated THEN score is 0\n- GIVEN total word count \u003c 500 WHEN word count component calculated THEN returns 5\n- GIVEN total word count 5000+ WHEN word count component calculated THEN returns 30\n- GIVEN 1 sample WHEN sample count component calculated THEN returns 4\n- GIVEN 6+ samples WHEN sample count component calculated THEN returns 20\n- GIVEN 1 content type WHEN type variety component calculated THEN returns 5\n- GIVEN 4+ content types WHEN type variety component calculated THEN returns 20\n- GIVEN only short samples WHEN length mix component calculated THEN returns 5\n- GIVEN all 3 length categories WHEN length mix component calculated THEN returns 15\n- GIVEN no DNA analysis done WHEN voice consistency component THEN returns 0 (max possible score is 85)\n- GIVEN DNA analysis with consistency score 80 WHEN mapped THEN returns 12 (80/100 * 15)\n\n## Files to Create/Modify\n- backend/app/services/scoring_service.py (create — ConfidenceScorer class)\n- backend/tests/test_services/test_scoring_service.py (create)\n\n## TDD Test Cases (Write First)\n1. test_no_samples_returns_zero\n2. test_word_count_tiers (parameterized: 100-\u003e5, 750-\u003e10, 2000-\u003e15, 4000-\u003e22, 6000-\u003e30)\n3. test_sample_count_tiers (parameterized: 1-\u003e4, 2-\u003e8, 3-\u003e12, 5-\u003e16, 8-\u003e20)\n4. test_type_variety_tiers (parameterized: 1-\u003e5, 2-\u003e10, 3-\u003e15, 5-\u003e20)\n5. test_length_mix_tiers (parameterized: 1cat-\u003e5, 2cat-\u003e10, 3cat-\u003e15)\n6. test_consistency_not_analyzed_returns_zero\n7. test_full_score_sums_all_components\n8. test_score_capped_at_100\n\n## Gotchas\n- Score is deterministic (no LLM call) except voice consistency\n- Confidence updates immediately when samples are added/removed\n- Voice consistency only updates after DNA analysis","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:03.974664-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:03.974664-07:00","dependencies":[{"issue_id":"sona-879","depends_on_id":"sona-8d7","type":"blocks","created_at":"2026-02-09T14:51:34.361265-07:00","created_by":"Ken Allred"},{"issue_id":"sona-879","depends_on_id":"sona-02q","type":"blocks","created_at":"2026-02-09T14:51:39.5153-07:00","created_by":"Ken Allred"}]}
{"id":"sona-8d7","title":"Implement clone CRUD backend service and API routes","description":"## Covers\nUS-008 (backend) — Voice clone creation, read, update, delete.\n\n## Acceptance Criteria\n- GIVEN POST /api/clones with {name, description, tags} WHEN name is valid THEN clone is created with type=original, id=nanoid, and returns 201\n- GIVEN GET /api/clones WHEN clones exist THEN returns paginated list with {items, total}\n- GIVEN GET /api/clones?type=original WHEN filter applied THEN only original clones returned\n- GIVEN GET /api/clones?search=marketing WHEN search applied THEN clones matching name are returned\n- GIVEN GET /api/clones/{id} WHEN clone exists THEN returns full clone detail with sample_count and confidence_score\n- GIVEN GET /api/clones/{id} WHEN clone does not exist THEN returns 404 with CLONE_NOT_FOUND\n- GIVEN PUT /api/clones/{id} with {name} WHEN valid THEN updates clone and returns 200\n- GIVEN DELETE /api/clones/{id} WHEN clone is not demo THEN deletes clone, samples, DNA versions and returns 204\n- GIVEN DELETE /api/clones/{id} WHEN clone is demo THEN returns 400 with DEMO_CLONE_READONLY\n\n## Files to Create/Modify\n- backend/app/services/clone_service.py (create)\n- backend/app/api/clones.py (create)\n- backend/app/api/router.py (modify — add clones router)\n- backend/tests/test_services/test_clone_service.py (create)\n- backend/tests/test_api/test_clones.py (create)\n\n## Key Interfaces\n- CloneService(session) with: create, get_by_id, list, update, delete\n- Uses CloneCreate, CloneUpdate, CloneResponse schemas\n\n## TDD Test Cases (Write First)\n1. test_create_clone_with_valid_data\n2. test_create_clone_generates_nanoid\n3. test_list_clones_returns_paginated\n4. test_list_clones_filters_by_type\n5. test_list_clones_searches_by_name\n6. test_get_clone_returns_detail\n7. test_get_clone_not_found_returns_404\n8. test_update_clone_name\n9. test_delete_clone_removes_cascade\n10. test_delete_demo_clone_rejected","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:39:37.778467-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:39:37.778467-07:00","dependencies":[{"issue_id":"sona-8d7","depends_on_id":"sona-moc","type":"blocks","created_at":"2026-02-09T14:50:31.813035-07:00","created_by":"Ken Allred"},{"issue_id":"sona-8d7","depends_on_id":"sona-mvk","type":"blocks","created_at":"2026-02-09T14:50:37.004139-07:00","created_by":"Ken Allred"},{"issue_id":"sona-8d7","depends_on_id":"sona-cco","type":"blocks","created_at":"2026-02-09T14:50:42.197246-07:00","created_by":"Ken Allred"}]}
{"id":"sona-8f5","title":"Build provider configuration UI with cards, forms, and connection test","description":"## Covers\nUS-002/003 (frontend) — Provider settings page.\n\n## Acceptance Criteria\n- GIVEN /settings/providers WHEN loaded THEN shows 3 provider cards (OpenAI, Anthropic, Google AI)\n- GIVEN a provider card WHEN no key configured THEN status shows gray dash 'Not Configured'\n- GIVEN a provider card WHEN key is entered and saved THEN key is masked showing last 4 chars\n- GIVEN a provider card WHEN 'Test Connection' clicked THEN shows loading spinner then result\n- GIVEN connection test succeeds THEN status turns green with 'Connected'\n- GIVEN connection test fails with auth error THEN shows specific error message\n- GIVEN multiple providers configured WHEN setting default THEN radio button selects default\n- GIVEN only one provider configured THEN it is auto-selected as default\n- GIVEN the form WHEN submitted with empty key THEN shows validation error\n\n## Files to Create/Modify\n- frontend/src/pages/settings/ProvidersPage.tsx (create)\n- frontend/src/components/settings/ProviderCard.tsx (create)\n- frontend/src/hooks/use-providers.ts (create — useProviders, useSaveProvider, useTestConnection)\n- frontend/src/test/handlers/providers.ts (modify — add handlers)\n- frontend/src/pages/settings/ProvidersPage.test.tsx (create)\n- frontend/src/components/settings/ProviderCard.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_three_provider_cards\n2. test_shows_not_configured_status\n3. test_masks_saved_key\n4. test_test_connection_loading_state\n5. test_test_connection_success\n6. test_test_connection_error\n7. test_default_provider_radio_selection\n8. test_form_validation_empty_key\n\n## Gotchas\n- Use React Hook Form + Zod for each card's form\n- Toast on save success/failure\n- Never display full API key after initial entry","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:42:35.292669-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:42:35.292669-07:00","dependencies":[{"issue_id":"sona-8f5","depends_on_id":"sona-bf7","type":"blocks","created_at":"2026-02-09T14:53:08.06249-07:00","created_by":"Ken Allred"},{"issue_id":"sona-8f5","depends_on_id":"sona-w7n","type":"blocks","created_at":"2026-02-09T14:53:13.283759-07:00","created_by":"Ken Allred"},{"issue_id":"sona-8f5","depends_on_id":"sona-fhi","type":"blocks","created_at":"2026-02-09T14:53:18.51428-07:00","created_by":"Ken Allred"},{"issue_id":"sona-8f5","depends_on_id":"sona-ad6","type":"blocks","created_at":"2026-02-09T14:53:23.743576-07:00","created_by":"Ken Allred"},{"issue_id":"sona-8f5","depends_on_id":"sona-szg","type":"blocks","created_at":"2026-02-09T14:53:28.973845-07:00","created_by":"Ken Allred"}]}
{"id":"sona-8ya","title":"Implement Voice DNA export as natural language prompt","description":"## Covers\nUS-053 — Export DNA as a human-readable prompt.\n\n## Acceptance Criteria\n- GIVEN Voice DNA tab WHEN 'Export as Prompt' clicked THEN generates natural language description of the voice\n- GIVEN exported prompt WHEN displayed THEN it's copyable to clipboard\n- GIVEN prompt format WHEN generated THEN it reads like: 'Write in a style that...' with specific voice characteristics\n\n## Files to Create/Modify\n- backend/app/services/dna_service.py (modify — add export_as_prompt)\n- frontend/src/components/clones/DnaExport.tsx (create)\n- backend/tests/test_services/test_dna_service.py (modify)\n- frontend/src/components/clones/DnaExport.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_export_generates_readable_prompt\n2. test_prompt_includes_key_characteristics\n3. test_copy_to_clipboard\n\n## Gotchas\n- This converts structured DNA JSON to prose — template-based, no LLM needed\n- Useful for users who want to use the voice in other tools","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:26.280649-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:26.280649-07:00","dependencies":[{"issue_id":"sona-8ya","depends_on_id":"sona-iu6","type":"blocks","created_at":"2026-02-09T14:59:19.063412-07:00","created_by":"Ken Allred"}]}
{"id":"sona-8yj","title":"Create tooling config files for linting, formatting, and type checking","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T10:41:35.281978-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T10:43:10.104429-07:00","closed_at":"2026-02-08T10:43:10.104429-07:00","close_reason":"Closed"}
{"id":"sona-994","title":"Build voice evolution timeline with dimension deltas","description":"## Covers\nUS-055 — Timeline view of DNA version changes.\n\n## Acceptance Criteria\n- GIVEN Voice DNA tab WHEN 'Timeline' view selected THEN shows chronological list of DNA versions\n- GIVEN each version WHEN displayed THEN shows dimension changes (deltas) from previous version\n- GIVEN dimension delta WHEN positive THEN shows green arrow up\n- GIVEN dimension delta WHEN negative THEN shows red arrow down\n\n## Files to Create/Modify\n- frontend/src/components/clones/DnaTimeline.tsx (create)\n- frontend/src/components/clones/DnaTimeline.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_timeline_shows_versions_chronologically\n2. test_dimension_deltas_calculated\n3. test_positive_delta_green_arrow\n4. test_negative_delta_red_arrow\n\n## Gotchas\n- Delta calculated from prominence_scores between consecutive versions\n- Only show dimensions with significant change (\u003e5 points)","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:31.483165-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:31.483165-07:00","dependencies":[{"issue_id":"sona-994","depends_on_id":"sona-vip","type":"blocks","created_at":"2026-02-09T14:59:24.300655-07:00","created_by":"Ken Allred"}]}
{"id":"sona-9b2","title":"Implement global keyboard shortcuts with command palette","description":"## Covers\nUS-047 — Global keyboard shortcuts.\n\n## Acceptance Criteria\n- GIVEN any page WHEN Cmd+K pressed THEN command palette opens with search for clones, content, pages\n- GIVEN any page WHEN Cmd+N pressed THEN navigates to /clones/new\n- GIVEN command palette WHEN typing THEN filters results in real-time\n- GIVEN command palette WHEN item selected THEN navigates to that item\n- GIVEN shortcuts WHEN used THEN browser defaults are prevented where appropriate\n\n## Files to Create/Modify\n- frontend/src/components/shared/CommandPalette.tsx (create)\n- frontend/src/hooks/use-keyboard-shortcuts.ts (create)\n- frontend/src/App.tsx (modify — add global shortcut listener)\n- frontend/src/components/shared/CommandPalette.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_cmd_k_opens_palette\n2. test_cmd_n_navigates_to_new_clone\n3. test_palette_search_filters_results\n4. test_palette_navigation\n5. test_escape_closes_palette\n\n## Gotchas\n- Use shadcn/ui Command component (based on cmdk)\n- Cmd on Mac, Ctrl on Windows/Linux\n- Prevent browser Cmd+K (browser search) default","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:05.396524-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:05.396524-07:00","dependencies":[{"issue_id":"sona-9b2","depends_on_id":"sona-1a4","type":"blocks","created_at":"2026-02-09T14:58:47.702877-07:00","created_by":"Ken Allred"}]}
{"id":"sona-9o6","title":"Build authenticity score display and integrate into content review panel","description":"## Covers\nUS-031/032 — Authenticity score UI in content review.\n\n## Acceptance Criteria\n- GIVEN content with authenticity score WHEN displayed THEN shows overall score badge (green 75+, yellow 50-74, red \u003c50)\n- GIVEN score breakdown WHEN displayed THEN shows 8 dimensions sorted by score (lowest first)\n- GIVEN a dimension below 70 WHEN expanded THEN shows actionable feedback with examples\n- GIVEN review panel WHEN rendered THEN authenticity score is shown alongside content\n- GIVEN 'Check Authenticity' button WHEN clicked THEN triggers scoring and shows result\n\n## Files to Create/Modify\n- frontend/src/components/content/AuthenticityScore.tsx (create)\n- frontend/src/components/content/DimensionBreakdown.tsx (create)\n- frontend/src/components/content/ReviewPanel.tsx (modify — integrate score display)\n- frontend/src/hooks/use-content.ts (modify — add useScoreContent)\n- frontend/src/components/content/AuthenticityScore.test.tsx (create)\n- frontend/src/components/content/DimensionBreakdown.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_overall_score_badge_colors\n2. test_dimensions_sorted_lowest_first\n3. test_low_dimension_shows_feedback\n4. test_check_authenticity_triggers_scoring\n5. test_score_integrated_in_review_panel\n\n## Gotchas\n- Dimension names from constants — match backend exactly\n- Feedback text comes from LLM scoring response\n- Score triggers a separate API call (POST /api/content/{id}/score)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:44:52.122447-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:44:52.122447-07:00","dependencies":[{"issue_id":"sona-9o6","depends_on_id":"sona-6c9","type":"blocks","created_at":"2026-02-09T14:56:47.49744-07:00","created_by":"Ken Allred"},{"issue_id":"sona-9o6","depends_on_id":"sona-zuv","type":"blocks","created_at":"2026-02-09T14:56:52.631411-07:00","created_by":"Ken Allred"}]}
{"id":"sona-9z8","title":"Implement content save, update, and version tracking backend","description":"## Covers\nUS-026/034/035 (backend) — Content CRUD and version history.\n\n## Acceptance Criteria\n- GIVEN POST /api/content (save after generation) WHEN content is new THEN creates Content + initial ContentVersion\n- GIVEN PUT /api/content/{id} with {content_current} WHEN content changed THEN creates new ContentVersion with trigger='inline_edit'\n- GIVEN PUT /api/content/{id} with {status} WHEN valid status THEN updates status\n- GIVEN GET /api/content/{id}/versions WHEN versions exist THEN returns list with: version_number, trigger, word_count, created_at\n- GIVEN POST /api/content/{id}/restore/{version} WHEN version exists THEN creates new version with old content, trigger='restore'\n- GIVEN DELETE /api/content/{id} WHEN content exists THEN deletes content and all versions, returns 204\n- GIVEN valid statuses WHEN used THEN they are: draft, review, approved, published, archived\n\n## Files to Create/Modify\n- backend/app/services/content_service.py (modify — add CRUD and versioning)\n- backend/app/api/content.py (modify — add CRUD endpoints)\n- backend/tests/test_services/test_content_service.py (modify — add CRUD tests)\n- backend/tests/test_api/test_content.py (modify — add CRUD endpoint tests)\n\n## TDD Test Cases (Write First)\n1. test_save_content_creates_initial_version\n2. test_update_content_creates_new_version\n3. test_update_status\n4. test_list_versions\n5. test_restore_version\n6. test_delete_content_cascades\n7. test_valid_status_transitions\n\n## Gotchas\n- Content stores both current and original (immutable) text\n- Version trigger types: generation, inline_edit, regeneration, feedback_driven, restore\n- Status transitions are flexible — any to any","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:30.224668-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:30.224668-07:00","dependencies":[{"issue_id":"sona-9z8","depends_on_id":"sona-d29","type":"blocks","created_at":"2026-02-09T14:52:36.805409-07:00","created_by":"Ken Allred"}]}
{"id":"sona-ad6","title":"Create MSW test handlers, render helper, and test factories","description":"## Covers\nInfrastructure — frontend test utilities.\n\n## Acceptance Criteria\n- GIVEN test/render.tsx WHEN renderWithProviders is called THEN it wraps component with QueryClientProvider (retry: false) and MemoryRouter\n- GIVEN test/handlers.ts WHEN server is started THEN it intercepts all /api/* routes with default responses\n- GIVEN test/factories.ts WHEN buildClone() is called THEN it returns a valid Clone object with sensible defaults\n- GIVEN test/factories.ts WHEN buildClone({name: 'Custom'}) is called THEN it returns a Clone with name='Custom' and other defaults\n- GIVEN test/factories.ts WHEN buildContent() is called THEN it returns a valid Content object\n- GIVEN test/setup.ts WHEN imported by Vitest THEN MSW server starts before all tests, resets after each, and stops after all\n\n## Files to Create/Modify\n- frontend/src/test/render.tsx (create — renderWithProviders)\n- frontend/src/test/handlers.ts (create — MSW server + default handlers)\n- frontend/src/test/handlers/clones.ts (create — clone API handlers)\n- frontend/src/test/handlers/content.ts (create — content API handlers)\n- frontend/src/test/handlers/providers.ts (create — provider API handlers)\n- frontend/src/test/handlers/methodology.ts (create — methodology API handlers)\n- frontend/src/test/factories.ts (create — buildClone, buildContent, buildSample, etc.)\n- frontend/src/test/setup.ts (create or modify — MSW lifecycle)\n\n## TDD Test Cases (Write First)\n1. test_render_helper_provides_query_client\n2. test_render_helper_provides_router\n3. test_build_clone_returns_valid_clone\n4. test_build_clone_accepts_overrides\n5. test_build_content_returns_valid_content\n6. test_msw_server_intercepts_clone_requests\n\n## Gotchas\n- MSW 2.x API: http.get() not rest.get()\n- Setup file must import @testing-library/jest-dom/vitest\n- QueryClient in tests: retry: false, gcTime: Infinity\n- handlers/ directory is append-only — each domain adds a file","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:37:30.163084-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:37:30.163084-07:00","dependencies":[{"issue_id":"sona-ad6","depends_on_id":"sona-fhi","type":"blocks","created_at":"2026-02-09T14:50:26.622152-07:00","created_by":"Ken Allred"}]}
{"id":"sona-az7","title":"Implement voice consistency scoring and wire to confidence","description":"## Covers\nUS-018 — Voice consistency component of confidence score.\n\n## Acceptance Criteria\n- GIVEN DNA analysis completes WHEN consistency is evaluated THEN LLM rates consistency 0-100\n- GIVEN consistency score is 80 WHEN mapped to confidence component THEN returns 12 (80 * 15 / 100)\n- GIVEN confidence score WHEN recalculated after DNA analysis THEN includes voice consistency component\n- GIVEN a clone with no DNA WHEN confidence calculated THEN voice consistency component is 0\n\n## Files to Create/Modify\n- backend/app/services/scoring_service.py (modify — add consistency mapping)\n- backend/app/services/dna_service.py (modify — extract consistency score from analysis)\n- backend/tests/test_services/test_scoring_service.py (modify — add consistency tests)\n\n## TDD Test Cases (Write First)\n1. test_consistency_score_mapped_to_15_point_scale\n2. test_confidence_includes_consistency_after_analysis\n3. test_confidence_zero_consistency_before_analysis\n\n## Gotchas\n- Consistency score is extracted from the DNA analysis LLM response (not a separate call)\n- Store on VoiceClone model or derive from latest DNA version","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:19.719156-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:19.719156-07:00","dependencies":[{"issue_id":"sona-az7","depends_on_id":"sona-onf","type":"blocks","created_at":"2026-02-09T14:52:05.452245-07:00","created_by":"Ken Allred"},{"issue_id":"sona-az7","depends_on_id":"sona-879","type":"blocks","created_at":"2026-02-09T14:52:10.667865-07:00","created_by":"Ken Allred"}]}
{"id":"sona-bf7","title":"Build frontend app layout shell with sidebar and routing","description":"## Covers\nInfrastructure — app shell with navigation.\n\n## Acceptance Criteria\n- GIVEN the user visits / WHEN the page loads THEN they are redirected to /clones\n- GIVEN the AppLayout WHEN rendered THEN it shows a sidebar with navigation links: Clones, Content Generator, Content Library, Settings\n- GIVEN the sidebar WHEN 'Clones' is clicked THEN the route changes to /clones\n- GIVEN the sidebar WHEN 'Settings' is clicked THEN it shows sub-links: Providers, Methodology\n- GIVEN the route matches /clones WHEN the page renders THEN the 'Clones' nav item is highlighted as active\n- GIVEN the app WHEN rendered at any route THEN the layout has a sidebar on the left and main content area on the right\n- GIVEN React Router WHEN all routes are defined THEN: /, /clones, /clones/new, /clones/:id, /clones/compare, /clones/merge, /create, /create/:id, /library, /settings/providers, /settings/methodology, /settings/presets, /design-system\n\n## Files to Create/Modify\n- frontend/src/App.tsx (modify — add routes and layout)\n- frontend/src/components/layout/AppLayout.tsx (create)\n- frontend/src/components/layout/Sidebar.tsx (create)\n- frontend/src/components/layout/Header.tsx (create)\n- frontend/src/pages/clones/ClonesPage.tsx (create — placeholder)\n- frontend/src/pages/create/CreatePage.tsx (create — placeholder)\n- frontend/src/pages/library/LibraryPage.tsx (create — placeholder)\n- frontend/src/pages/settings/ProvidersPage.tsx (create — placeholder)\n- frontend/src/pages/settings/MethodologyPage.tsx (create — placeholder)\n\n## TDD Test Cases (Write First)\n1. test_sidebar_renders_all_nav_links\n2. test_sidebar_highlights_active_route\n3. test_root_redirects_to_clones\n4. test_layout_renders_sidebar_and_content_area\n5. test_settings_shows_sub_navigation\n\n## Gotchas\n- Use shadcn/ui components for sidebar styling\n- Sidebar should be collapsible (state in Zustand ui-store)\n- Use cn() for all conditional classes\n- Placeholder pages just render the page title — content comes in Wave 2","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:37:14.462996-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:37:14.462996-07:00"}
{"id":"sona-bs1","title":"Build content generator page with voice selector, input, and properties form","description":"## Covers\nUS-022 (frontend) — Content generator page structure.\n\n## Acceptance Criteria\n- GIVEN /create WHEN loaded THEN shows: voice clone selector, input textarea, properties form, generate button\n- GIVEN voice selector WHEN expanded THEN shows searchable dropdown with clone name + confidence badge\n- GIVEN voice selector WHEN clone with confidence \u003c 60 selected THEN shows warning icon\n- GIVEN properties form WHEN rendered THEN shows: platform checkboxes, length radio, tone/humor/formality sliders, target audience, CTA style, include/exclude phrases\n- GIVEN generate button WHEN no clone selected THEN disabled with tooltip\n- GIVEN generate button WHEN no input text THEN disabled with tooltip\n- GIVEN generate button WHEN no platform selected THEN disabled with tooltip\n- GIVEN most recently used clone WHEN page revisited THEN pre-selected\n\n## Files to Create/Modify\n- frontend/src/pages/create/CreatePage.tsx (modify — full implementation)\n- frontend/src/components/content/VoiceSelector.tsx (create)\n- frontend/src/components/content/ContentInput.tsx (create)\n- frontend/src/components/content/PropertiesForm.tsx (create)\n- frontend/src/stores/generator-store.ts (create — last used clone, last used properties)\n- frontend/src/hooks/use-content.ts (create)\n- frontend/src/pages/create/CreatePage.test.tsx (create)\n- frontend/src/components/content/VoiceSelector.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_voice_selector_and_input\n2. test_voice_selector_shows_clones\n3. test_low_confidence_warning\n4. test_properties_form_fields\n5. test_generate_disabled_without_clone\n6. test_generate_disabled_without_input\n7. test_generate_disabled_without_platform\n8. test_last_used_clone_preselected\n\n## Gotchas\n- Sliders default to 'Inherit from DNA' (middle position)\n- Platform checkboxes: at least one required\n- Use Zustand for generator store (persisted)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:43:17.27338-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:43:17.27338-07:00","dependencies":[{"issue_id":"sona-bs1","depends_on_id":"sona-bf7","type":"blocks","created_at":"2026-02-09T14:55:18.66609-07:00","created_by":"Ken Allred"},{"issue_id":"sona-bs1","depends_on_id":"sona-w7n","type":"blocks","created_at":"2026-02-09T14:55:23.893721-07:00","created_by":"Ken Allred"},{"issue_id":"sona-bs1","depends_on_id":"sona-fhi","type":"blocks","created_at":"2026-02-09T14:55:29.124673-07:00","created_by":"Ken Allred"},{"issue_id":"sona-bs1","depends_on_id":"sona-ad6","type":"blocks","created_at":"2026-02-09T14:55:34.357048-07:00","created_by":"Ken Allred"},{"issue_id":"sona-bs1","depends_on_id":"sona-8d7","type":"blocks","created_at":"2026-02-09T14:55:39.583002-07:00","created_by":"Ken Allred"}]}
{"id":"sona-c2s","title":"Implement context-specific keyboard shortcuts","description":"## Covers\nUS-048 — Page-specific keyboard shortcuts.\n\n## Acceptance Criteria\n- GIVEN content generator WHEN Cmd+Enter pressed THEN triggers generate\n- GIVEN content generator WHEN Cmd+Shift+Enter pressed THEN triggers generate variants\n- GIVEN content generator WHEN Cmd+S pressed THEN saves to library\n- GIVEN content library WHEN Cmd+F pressed THEN focuses search input\n- GIVEN content library WHEN Cmd+A pressed THEN selects all visible items\n- GIVEN shortcuts WHEN displayed in tooltips THEN button tooltips show shortcut hints\n\n## Files to Create/Modify\n- frontend/src/hooks/use-keyboard-shortcuts.ts (modify — add context shortcuts)\n- frontend/src/pages/create/CreatePage.tsx (modify — wire shortcuts)\n- frontend/src/pages/library/LibraryPage.tsx (modify — wire shortcuts)\n\n## TDD Test Cases (Write First)\n1. test_cmd_enter_generates\n2. test_cmd_shift_enter_generates_variants\n3. test_cmd_s_saves\n4. test_cmd_f_focuses_search\n5. test_cmd_a_selects_all\n\n## Gotchas\n- Shortcuts only active when on the correct page\n- Prevent browser Cmd+S (save page) default\n- Tooltip hints: 'Generate (⌘↵)'","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:10.626522-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:10.626522-07:00","dependencies":[{"issue_id":"sona-c2s","depends_on_id":"sona-6c9","type":"blocks","created_at":"2026-02-09T14:58:52.939015-07:00","created_by":"Ken Allred"},{"issue_id":"sona-c2s","depends_on_id":"sona-4g8","type":"blocks","created_at":"2026-02-09T14:58:58.16997-07:00","created_by":"Ken Allred"}]}
{"id":"sona-cco","title":"Create all Pydantic request/response schemas","description":"## Covers\nInfrastructure — API contract definitions for all domains.\n\n## Acceptance Criteria\n- GIVEN CloneCreate schema WHEN name is empty THEN validation fails\n- GIVEN CloneResponse schema WHEN model_validate is called with a VoiceClone ORM object THEN all fields are correctly mapped\n- GIVEN CloneListResponse WHEN constructed THEN it has items (list[CloneResponse]) and total (int)\n- GIVEN ContentCreate schema WHEN platform is not in allowed values THEN validation fails\n- GIVEN SampleCreate schema WHEN source_type is 'paste' THEN content is required\n- GIVEN ProviderUpdate schema WHEN api_key is provided THEN model is also required\n- GIVEN MethodologyUpdate schema WHEN content is empty string THEN validation fails\n- GIVEN all schemas WHEN used with model_config THEN from_attributes=True is set for response schemas\n\n## Files to Create/Modify\n- backend/app/schemas/__init__.py (create)\n- backend/app/schemas/clone.py (create — CloneCreate, CloneUpdate, CloneResponse, CloneListResponse)\n- backend/app/schemas/sample.py (create — SampleCreate, SampleResponse, SampleListResponse)\n- backend/app/schemas/dna.py (create — DNAResponse, DNAVersionResponse, DNAVersionListResponse)\n- backend/app/schemas/content.py (create — ContentCreate, ContentUpdate, ContentResponse, ContentListResponse, GenerateRequest)\n- backend/app/schemas/methodology.py (create — MethodologyResponse, MethodologyUpdate, MethodologyVersionResponse)\n- backend/app/schemas/provider.py (create — ProviderResponse, ProviderUpdate, ProviderTestResponse)\n- backend/app/schemas/scoring.py (create — AuthenticityScoreResponse, DimensionScore)\n- backend/app/schemas/preset.py (create — PresetCreate, PresetUpdate, PresetResponse)\n\n## TDD Test Cases (Write First)\n1. test_clone_create_requires_name\n2. test_clone_create_rejects_empty_name\n3. test_clone_response_from_orm\n4. test_content_create_validates_platform_enum\n5. test_sample_create_paste_requires_content\n6. test_provider_update_validates_api_key_with_model\n7. test_methodology_update_rejects_empty_content\n8. test_generate_request_requires_clone_id_and_platform\n\n## Gotchas\n- Use model_config = ConfigDict(from_attributes=True) on all response schemas\n- Enum fields use Python StrEnum for type safety\n- Tags fields accept list[str], stored as JSON in DB\n- Confidence score fields are int (0-100)\n- Masked key in ProviderResponse: only last 4 chars","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:36:48.401972-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:36:48.401972-07:00","dependencies":[{"issue_id":"sona-cco","depends_on_id":"sona-moc","type":"blocks","created_at":"2026-02-09T14:50:00.695535-07:00","created_by":"Ken Allred"}]}
{"id":"sona-cwg","title":"Implement token cost estimator with per-operation estimates","description":"## Covers\nUS-028/I3 — Token cost estimation and tracking.\n\n## Acceptance Criteria\n- GIVEN DNA analysis WHEN estimate requested THEN shows: estimated input tokens, output tokens, cost based on model pricing\n- GIVEN content generation WHEN estimate requested THEN shows: estimated cost per platform version\n- GIVEN cost estimate WHEN displayed THEN format is '$0.03 estimated' with tooltip showing token breakdown\n- GIVEN /settings/providers WHEN viewed THEN shows cumulative estimated spend per provider (reset monthly)\n- GIVEN MODEL_PRICING constant WHEN queried THEN returns per-token prices for all supported models\n- GIVEN estimate disclaimer WHEN shown THEN text is 'Estimates are approximate and may differ from actual provider billing'\n\n## Files to Create/Modify\n- backend/app/services/cost_estimator.py (create)\n- backend/app/constants.py (modify — ensure MODEL_PRICING is complete)\n- frontend/src/components/shared/CostEstimate.tsx (create)\n- backend/tests/test_services/test_cost_estimator.py (create)\n- frontend/src/components/shared/CostEstimate.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_estimate_dna_analysis_tokens\n2. test_estimate_generation_cost\n3. test_cost_format_display\n4. test_cumulative_spend_tracking\n5. test_model_pricing_includes_all_models\n\n## Gotchas\n- Token estimation: approximate (chars / 4) or use tiktoken for OpenAI\n- Cost displayed in USD\n- Cumulative spend is local tracking only — not from provider","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:19.756169-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:19.756169-07:00","dependencies":[{"issue_id":"sona-cwg","depends_on_id":"sona-szg","type":"blocks","created_at":"2026-02-09T14:57:34.482299-07:00","created_by":"Ken Allred"},{"issue_id":"sona-cwg","depends_on_id":"sona-onf","type":"blocks","created_at":"2026-02-09T14:57:39.706166-07:00","created_by":"Ken Allred"},{"issue_id":"sona-cwg","depends_on_id":"sona-d29","type":"blocks","created_at":"2026-02-09T14:57:44.93423-07:00","created_by":"Ken Allred"}]}
{"id":"sona-d29","title":"Implement content generation backend with multi-platform parallel LLM","description":"## Covers\nUS-023 (backend) — Content generation with voice DNA and platform optimization.\n\n## Acceptance Criteria\n- GIVEN POST /api/content/generate with {clone_id, input_text, platforms, properties} WHEN valid THEN generates content for each platform\n- GIVEN multiple platforms WHEN generating THEN each platform gets a separate LLM call (can run in parallel via asyncio.gather)\n- GIVEN generation prompt WHEN constructed THEN it includes: Voice DNA JSON, authenticity guidelines, platform best practices, user input, all properties\n- GIVEN generation properties WHEN tone/humor/formality overrides are set THEN they override DNA defaults in the prompt\n- GIVEN generated content WHEN returned THEN includes: content text, word_count, char_count, platform\n- GIVEN POST /api/content/generate/stream WHEN called THEN returns SSE stream of generation progress\n- GIVEN clone_id WHEN clone has no DNA THEN returns 400 with 'Analyze Voice DNA before generating content'\n- GIVEN no provider configured WHEN generate called THEN returns 400 with ProviderNotConfiguredError\n\n## Files to Create/Modify\n- backend/app/services/content_service.py (create)\n- backend/app/api/content.py (create)\n- backend/app/api/router.py (modify — add content router)\n- backend/tests/test_services/test_content_service.py (create)\n- backend/tests/test_api/test_content.py (create)\n\n## TDD Test Cases (Write First)\n1. test_generate_single_platform\n2. test_generate_multiple_platforms_parallel\n3. test_prompt_includes_voice_dna\n4. test_prompt_includes_methodology\n5. test_property_overrides_in_prompt\n6. test_response_includes_word_and_char_count\n7. test_generate_without_dna_returns_error\n8. test_generate_without_provider_returns_error\n9. test_stream_returns_sse_events\n\n## Gotchas\n- Use asyncio.gather for parallel platform generation\n- Content is saved as draft status automatically\n- Authenticity score is calculated separately (task 24)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:24.979344-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:24.979344-07:00","dependencies":[{"issue_id":"sona-d29","depends_on_id":"sona-moc","type":"blocks","created_at":"2026-02-09T14:52:15.898501-07:00","created_by":"Ken Allred"},{"issue_id":"sona-d29","depends_on_id":"sona-cco","type":"blocks","created_at":"2026-02-09T14:52:21.128463-07:00","created_by":"Ken Allred"},{"issue_id":"sona-d29","depends_on_id":"sona-535","type":"blocks","created_at":"2026-02-09T14:52:26.351532-07:00","created_by":"Ken Allred"},{"issue_id":"sona-d29","depends_on_id":"sona-dfe","type":"blocks","created_at":"2026-02-09T14:52:31.56919-07:00","created_by":"Ken Allred"}]}
{"id":"sona-dfe","title":"Seed default methodology content for all 3 sections","description":"## Covers\nUS-005 — Default methodology content seeded on first startup.\n\n## Acceptance Criteria\n- GIVEN the database is empty WHEN the app starts THEN 3 methodology sections are created: voice_cloning, authenticity, platform_practices\n- GIVEN voice_cloning section WHEN seeded THEN content covers: analysis framework (9 dimensions), output format (structured JSON), prominence scoring, consistency evaluation\n- GIVEN authenticity section WHEN seeded THEN content covers: AI tell avoidance, voice element incorporation, natural imperfection, vocabulary matching\n- GIVEN platform_practices section WHEN seeded THEN content covers per-platform rules for: LinkedIn, Twitter/X, Facebook, Instagram, Blog, Email, Newsletter, SMS\n- GIVEN sections already exist WHEN app restarts THEN seeding is skipped (idempotent)\n\n## Files to Create/Modify\n- backend/app/seed.py (create — seed_methodology_defaults function)\n- backend/app/main.py (modify — call seed in lifespan)\n- backend/tests/test_seed.py (create)\n\n## TDD Test Cases (Write First)\n1. test_seed_creates_three_sections\n2. test_seed_idempotent_on_second_run\n3. test_voice_cloning_content_covers_dimensions\n4. test_authenticity_content_covers_ai_tells\n5. test_platform_content_covers_all_platforms\n\n## Gotchas\n- Default content should be high quality — this directly affects LLM output quality\n- Each section gets version_number=1, trigger='seed'\n- Seed runs inside a transaction — all or nothing","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:39:53.557002-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:39:53.557002-07:00","dependencies":[{"issue_id":"sona-dfe","depends_on_id":"sona-o8k","type":"blocks","created_at":"2026-02-09T14:51:18.640717-07:00","created_by":"Ken Allred"}]}
{"id":"sona-di2","title":"Build add sample dialog with paste flow and sample list","description":"## Covers\nUS-009 (frontend) — Adding samples via paste and viewing sample list.\n\n## Acceptance Criteria\n- GIVEN Samples tab WHEN 'Add Sample' clicked THEN opens dialog with paste tab active\n- GIVEN paste flow WHEN text entered and content type selected THEN 'Add' button is enabled\n- GIVEN paste flow WHEN 'Add' is clicked THEN sample is created and dialog closes\n- GIVEN sample list WHEN samples exist THEN shows: content type, word count, source type, date, delete button\n- GIVEN sample list WHEN delete clicked THEN shows confirmation and deletes\n- GIVEN sample list WHEN empty THEN shows 'No samples yet' empty state\n- GIVEN confidence score panel WHEN displayed THEN shows breakdown of all 5 components\n\n## Files to Create/Modify\n- frontend/src/components/samples/AddSampleDialog.tsx (create)\n- frontend/src/components/samples/SampleList.tsx (create)\n- frontend/src/components/samples/ConfidenceBreakdown.tsx (create)\n- frontend/src/hooks/use-samples.ts (create)\n- frontend/src/components/samples/AddSampleDialog.test.tsx (create)\n- frontend/src/components/samples/SampleList.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_dialog_opens_with_paste_tab\n2. test_paste_requires_text_and_content_type\n3. test_add_creates_sample\n4. test_sample_list_shows_items\n5. test_sample_delete_with_confirmation\n6. test_empty_state\n7. test_confidence_breakdown_components\n\n## Gotchas\n- Content type dropdown: tweet, thread, linkedin_post, blog_post, article, email, newsletter, essay, other\n- Dialog should use shadcn/ui Dialog component\n- Confidence breakdown is a side panel on the Samples tab","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:42:56.287882-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:42:56.287882-07:00","dependencies":[{"issue_id":"sona-di2","depends_on_id":"sona-0ya","type":"blocks","created_at":"2026-02-09T14:54:36.929398-07:00","created_by":"Ken Allred"},{"issue_id":"sona-di2","depends_on_id":"sona-02q","type":"blocks","created_at":"2026-02-09T14:54:42.158886-07:00","created_by":"Ken Allred"}]}
{"id":"sona-dxa","title":"Build interactive Voice DNA radar chart with Recharts","description":"## Covers\nUS-020 — Radar chart visualization for Voice DNA.\n\n## Acceptance Criteria\n- GIVEN Voice DNA tab WHEN DNA has prominence_scores THEN renders RadarChart with 9 axes\n- GIVEN radar chart WHEN hovering an axis THEN shows tooltip with key details for that category\n- GIVEN radar chart WHEN rendered THEN axes are: Vocabulary, Sentence Structure, Paragraph Structure, Tone, Rhetorical Devices, Punctuation, Openings/Closings, Humor, Signatures\n- GIVEN radar chart WHEN used on clone card THEN renders as small non-interactive thumbnail\n- GIVEN no prominence_scores WHEN rendering THEN shows placeholder\n\n## Files to Create/Modify\n- frontend/src/components/clones/DnaRadar.tsx (create)\n- frontend/src/components/clones/DnaRadar.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_radar_chart_with_9_axes\n2. test_hover_shows_tooltip\n3. test_thumbnail_mode_non_interactive\n4. test_handles_missing_scores\n\n## Gotchas\n- Use Recharts RadarChart component\n- Color per clone (for comparison view later)\n- Thumbnail: small size, no hover, no labels","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:44:46.874635-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:44:46.874635-07:00","dependencies":[{"issue_id":"sona-dxa","depends_on_id":"sona-iu6","type":"blocks","created_at":"2026-02-09T14:56:42.278158-07:00","created_by":"Ken Allred"}]}
{"id":"sona-e3g","title":"Update commit message convention to use [BD-xxx] instead of [BD-sona-xxx]","status":"closed","priority":2,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T08:27:07.717949-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T08:27:25.084597-07:00","closed_at":"2026-02-08T08:27:25.084597-07:00","close_reason":"Closed"}
{"id":"sona-e6u","title":"Build keyboard shortcut help overlay","description":"## Covers\nUS-049 — Keyboard shortcut cheat sheet.\n\n## Acceptance Criteria\n- GIVEN any page WHEN ? pressed (outside text input) THEN shortcut help overlay appears\n- GIVEN overlay WHEN shown THEN lists all shortcuts grouped by: Global, Content Generator, Content Library\n- GIVEN overlay WHEN Escape pressed THEN closes\n\n## Files to Create/Modify\n- frontend/src/components/shared/ShortcutHelp.tsx (create)\n- frontend/src/components/shared/ShortcutHelp.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_question_mark_opens_overlay\n2. test_overlay_lists_all_shortcuts\n3. test_escape_closes_overlay\n4. test_not_triggered_in_text_input\n\n## Gotchas\n- ? should NOT trigger when focus is in a text input or textarea\n- Use shadcn/ui Dialog for overlay","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:15.835009-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:15.835009-07:00","dependencies":[{"issue_id":"sona-e6u","depends_on_id":"sona-9b2","type":"blocks","created_at":"2026-02-09T14:59:03.393536-07:00","created_by":"Ken Allred"},{"issue_id":"sona-e6u","depends_on_id":"sona-c2s","type":"blocks","created_at":"2026-02-09T14:59:08.620677-07:00","created_by":"Ken Allred"}]}
{"id":"sona-eet","title":"Create docs/tdd-standards.md and update tech-stack.md and coding-standards.md for TDD","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T11:04:28.276756-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T11:10:40.819217-07:00","closed_at":"2026-02-08T11:10:40.819217-07:00","close_reason":"Closed"}
{"id":"sona-ega","title":"Add database naming convention, base exceptions, and constants","description":"## Covers\nInfrastructure — shared foundation for all backend code.\n\n## Acceptance Criteria\n- GIVEN the database module WHEN Base is imported THEN MetaData uses the naming convention (ix_, uq_, ck_, fk_, pk_ prefixes)\n- GIVEN app/exceptions.py WHEN a domain error is raised THEN it has detail (str) and code (str) attributes\n- GIVEN app/constants.py WHEN imported THEN it exports platform definitions, confidence thresholds, model pricing, and version retention limits\n- GIVEN app/main.py WHEN a SonaError is raised THEN the global exception handler returns JSON {detail, code} with the correct HTTP status\n\n## Files to Create/Modify\n- backend/app/database.py (modify — add naming convention to Base)\n- backend/app/exceptions.py (create — SonaError hierarchy)\n- backend/app/constants.py (create — all constants)\n- backend/app/main.py (modify — add global exception handler)\n\n## TDD Test Cases (Write First)\n1. test_sona_error_has_detail_and_code\n2. test_clone_not_found_error_formats_message\n3. test_provider_not_configured_error_code\n4. test_global_handler_returns_404_for_not_found\n5. test_global_handler_returns_502_for_llm_error\n6. test_confidence_thresholds_are_correct_values\n7. test_platform_definitions_include_all_platforms\n\n## Gotchas\n- The naming convention must be on MetaData, not Base directly\n- exceptions.py is append-only — all future tasks add to it\n- constants.py is append-only — use typed dicts for structured constants","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:34:24.875302-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:34:44.489479-07:00"}
{"id":"sona-eox","title":"Implement content library backend with filters, search, pagination, bulk ops","description":"## Covers\nUS-036-039 (backend) — Content library API with filtering.\n\n## Acceptance Criteria\n- GIVEN GET /api/content WHEN no filters THEN returns paginated list sorted by created_at desc\n- GIVEN GET /api/content?clone_id=abc WHEN filter applied THEN only content for that clone returned\n- GIVEN GET /api/content?platform=linkedin WHEN filter applied THEN only LinkedIn content returned\n- GIVEN GET /api/content?status=draft WHEN filter applied THEN only drafts returned\n- GIVEN GET /api/content?search=keyword WHEN search applied THEN content matching keyword in content_current returned\n- GIVEN GET /api/content?sort=authenticity_score\u0026order=desc WHEN sorted THEN results ordered by score\n- GIVEN POST /api/content/bulk/status with {ids, status} WHEN valid THEN updates all specified content items\n- GIVEN POST /api/content/bulk/delete with {ids} WHEN valid THEN deletes all specified content items\n- GIVEN POST /api/content/bulk/tag with {ids, tags} WHEN valid THEN adds tags to all specified items\n- GIVEN all filters WHEN combined THEN they use AND logic\n\n## Files to Create/Modify\n- backend/app/services/content_service.py (modify — add list with filters, bulk ops)\n- backend/app/api/content.py (modify — add filter params, bulk endpoints)\n- backend/tests/test_services/test_content_service.py (modify — add filter tests)\n- backend/tests/test_api/test_content.py (modify — add filter endpoint tests)\n\n## TDD Test Cases (Write First)\n1. test_list_content_paginated\n2. test_filter_by_clone\n3. test_filter_by_platform\n4. test_filter_by_status\n5. test_full_text_search\n6. test_sort_by_score\n7. test_combined_filters\n8. test_bulk_status_update\n9. test_bulk_delete\n10. test_bulk_tag_add\n\n## Gotchas\n- SQLite full-text search: use LIKE for v1 (FTS5 later if needed)\n- Bulk operations should be atomic (all or nothing)\n- Filter state persisted in URL params (frontend handles this)","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:40.73258-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:40.73258-07:00","dependencies":[{"issue_id":"sona-eox","depends_on_id":"sona-9z8","type":"blocks","created_at":"2026-02-09T14:52:52.482835-07:00","created_by":"Ken Allred"}]}
{"id":"sona-ey7","title":"Fix CI: add packageManager field to frontend/package.json for pnpm/action-setup","status":"closed","priority":0,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T21:48:56.645272-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T21:51:56.414711-07:00","closed_at":"2026-02-08T21:51:56.414711-07:00","close_reason":"Closed"}
{"id":"sona-ezx","title":"Implement before/after view toggle in content generator","description":"## Covers\nUS-046 — Before/after split view in review panel.\n\n## Acceptance Criteria\n- GIVEN review panel toolbar WHEN 'Show Input' toggle exists THEN clicking it shows split view\n- GIVEN split view WHEN active THEN shows: original input on left (read-only), generated content on right (editable)\n- GIVEN toggle state WHEN changed THEN persisted in local storage via Zustand\n- GIVEN default state WHEN page loads THEN toggle is off (output-only view)\n\n## Files to Create/Modify\n- frontend/src/components/content/BeforeAfterView.tsx (create)\n- frontend/src/components/content/ReviewPanel.tsx (modify — add toggle)\n- frontend/src/stores/ui-store.ts (modify — add showInputPanel)\n- frontend/src/components/content/BeforeAfterView.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_toggle_shows_split_view\n2. test_input_panel_read_only\n3. test_output_panel_editable\n4. test_toggle_state_persisted\n5. test_default_off\n\n## Gotchas\n- Split view: 50/50 side by side\n- Input panel shows the original user input, not the generated content","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:00.186287-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:00.186287-07:00","dependencies":[{"issue_id":"sona-ezx","depends_on_id":"sona-6c9","type":"blocks","created_at":"2026-02-09T14:58:42.470536-07:00","created_by":"Ken Allred"}]}
{"id":"sona-fbp","title":"Build quick generate panel on clone detail page","description":"## Covers\nUS-029 — Quick Generate from clone detail.\n\n## Acceptance Criteria\n- GIVEN clone detail header WHEN 'Quick Generate' clicked THEN opens inline generation panel\n- GIVEN quick generate panel WHEN shown THEN has: text input, platform selector, length selector, Generate button\n- GIVEN quick generate WHEN clone is auto-selected THEN no clone selector needed\n- GIVEN generated content WHEN shown inline THEN displays with authenticity score\n- GIVEN 'Save to Library' WHEN clicked THEN saves content\n- GIVEN 'Open in Generator' WHEN clicked THEN navigates to /create with content pre-loaded\n\n## Files to Create/Modify\n- frontend/src/components/clones/QuickGenerate.tsx (create)\n- frontend/src/pages/clones/CloneDetailPage.tsx (modify — add quick generate)\n- frontend/src/components/clones/QuickGenerate.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_panel_opens_on_click\n2. test_auto_selects_current_clone\n3. test_generate_shows_result\n4. test_save_to_library\n5. test_open_in_generator_navigates\n\n## Gotchas\n- Panel is a slide-out or expandable section\n- Inherits default generation properties\n- Quick path for common workflow","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:30.188207-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:30.188207-07:00","dependencies":[{"issue_id":"sona-fbp","depends_on_id":"sona-0ya","type":"blocks","created_at":"2026-02-09T14:58:00.615844-07:00","created_by":"Ken Allred"},{"issue_id":"sona-fbp","depends_on_id":"sona-6c9","type":"blocks","created_at":"2026-02-09T14:58:05.852199-07:00","created_by":"Ken Allred"}]}
{"id":"sona-fhi","title":"Create frontend TypeScript types and Zod schemas","description":"## Covers\nInfrastructure — shared type definitions and runtime validation schemas.\n\n## Acceptance Criteria\n- GIVEN types/api.ts WHEN Clone type is used THEN it has: id, name, description, type, tags, is_demo, is_hidden, confidence_score, sample_count, created_at, updated_at\n- GIVEN types/api.ts WHEN Content type is used THEN it has: id, clone_id, clone_name, platform, status, content_current, content_original, input_text, generation_properties, authenticity_score, score_dimensions, topic, campaign, tags, word_count, char_count, created_at, updated_at\n- GIVEN types/platforms.ts WHEN PLATFORMS constant is used THEN it includes all 9 platforms with labels and char limits\n- GIVEN types/dna.ts WHEN VoiceDNA type is used THEN it has all 9 DNA categories with typed sub-fields\n- GIVEN Zod schemas WHEN parsing valid API responses THEN they succeed\n- GIVEN Zod schemas WHEN parsing invalid data THEN they throw ZodError\n\n## Files to Create/Modify\n- frontend/src/types/api.ts (create — Zod schemas + inferred types for all entities)\n- frontend/src/types/platforms.ts (create — platform definitions)\n- frontend/src/types/dna.ts (create — Voice DNA type definitions)\n- frontend/src/types/errors.ts (create — ApiError type if not already)\n\n## TDD Test Cases (Write First)\n1. test_clone_schema_parses_valid_data\n2. test_clone_schema_rejects_missing_id\n3. test_content_schema_parses_valid_data\n4. test_platform_definitions_include_all_platforms\n5. test_dna_schema_parses_full_dna_structure\n\n## Gotchas\n- Types derived from Zod schemas via z.infer\u003ctypeof schema\u003e\n- Platform constants must match backend constants.py exactly\n- Use z.enum for status and type fields\n- DNA type is complex nested structure — keep it readable","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:37:24.920223-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:37:24.920223-07:00"}
{"id":"sona-ggg","title":"Create Product Requirements Document for Sona","status":"closed","priority":0,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T08:11:47.646145-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T08:15:33.598953-07:00","closed_at":"2026-02-08T08:15:33.598953-07:00","close_reason":"Closed"}
{"id":"sona-gog","title":"Build library filtering, search, and bulk actions UI","description":"## Covers\nUS-037/038/039 (frontend) — Library filters, search, and bulk operations.\n\n## Acceptance Criteria\n- GIVEN library page WHEN filter bar shown THEN includes: clone dropdown, platform checkboxes, status tabs, search input, date range\n- GIVEN search input WHEN text entered THEN filters content by keyword in real-time\n- GIVEN filters WHEN applied THEN URL params update (shareable/bookmarkable)\n- GIVEN checkbox selection WHEN items selected THEN bulk action bar appears with: Change Status, Add Tags, Delete\n- GIVEN bulk delete WHEN clicked THEN shows confirmation dialog with item count\n- GIVEN 'Clear filters' button WHEN clicked THEN resets all filters\n- GIVEN combined filters WHEN applied THEN they use AND logic\n\n## Files to Create/Modify\n- frontend/src/components/content/LibraryFilters.tsx (create)\n- frontend/src/components/content/BulkActions.tsx (create)\n- frontend/src/pages/library/LibraryPage.tsx (modify — add filters and bulk actions)\n- frontend/src/components/content/LibraryFilters.test.tsx (create)\n- frontend/src/components/content/BulkActions.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_filter_by_clone\n2. test_filter_by_platform\n3. test_filter_by_status_tabs\n4. test_search_filters_content\n5. test_url_params_reflect_filters\n6. test_bulk_action_bar_appears\n7. test_bulk_delete_confirmation\n8. test_clear_filters\n\n## Gotchas\n- Use React Router useSearchParams for filter state in URL\n- Status tabs: All, Draft, Review, Approved, Published, Archived\n- Bulk actions bar is sticky at bottom when items selected","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:43:32.997523-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:43:32.997523-07:00","dependencies":[{"issue_id":"sona-gog","depends_on_id":"sona-4g8","type":"blocks","created_at":"2026-02-09T14:56:21.354948-07:00","created_by":"Ken Allred"}]}
{"id":"sona-h9f","title":"Implement Google AI LLM provider","description":"## Covers\nUS-001 (Google) — Google Generative AI provider implementation.\n\n## Acceptance Criteria\n- GIVEN GoogleProvider WHEN complete() is called THEN it calls google.generativeai and returns generated text\n- GIVEN GoogleProvider WHEN stream() is called THEN it yields chunks from Google streaming response\n- GIVEN GoogleProvider WHEN test_connection() is called THEN it sends a minimal API call and returns True on success\n- GIVEN a google API auth error WHEN caught THEN it raises LLMAuthError\n\n## Files to Create/Modify\n- backend/app/llm/google.py (create)\n\n## TDD Test Cases (Write First)\n1. test_complete_returns_response_text\n2. test_stream_yields_chunks\n3. test_test_connection_returns_true\n4. test_auth_error_maps_correctly\n\n## Gotchas\n- google-generativeai SDK has different API shape than OpenAI/Anthropic\n- Configure via genai.configure(api_key=...) then genai.GenerativeModel(model)","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:37:09.237005-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:37:09.237005-07:00","dependencies":[{"issue_id":"sona-h9f","depends_on_id":"sona-535","type":"blocks","created_at":"2026-02-09T14:50:21.438712-07:00","created_by":"Ken Allred"}]}
{"id":"sona-i0j","title":"Build AI detection preview with flagged passages","description":"## Covers\nUS-033 — AI detection analysis UI.\n\n## Acceptance Criteria\n- GIVEN review panel WHEN 'Check AI Detection' clicked THEN LLM evaluates content for AI signals\n- GIVEN detection result WHEN returned THEN shows overall risk: Low/Medium/High with color\n- GIVEN flagged passages WHEN displayed THEN each shows: highlighted text, reason, suggested fix\n- GIVEN cost estimate WHEN shown before check THEN displays estimated cost\n- GIVEN disclaimer WHEN shown THEN text matches PRD\n\n## Files to Create/Modify\n- backend/app/services/detection_service.py (create)\n- backend/app/api/content.py (modify — add detection endpoint)\n- frontend/src/components/content/AiDetectionPreview.tsx (create)\n- backend/tests/test_services/test_detection_service.py (create)\n- frontend/src/components/content/AiDetectionPreview.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_detection_returns_risk_level\n2. test_detection_returns_flagged_passages\n3. test_flagged_passage_has_reason_and_fix\n4. test_risk_level_colors\n5. test_disclaimer_text\n\n## Gotchas\n- Detection is a separate LLM call — not automatic\n- Flagged passages reference specific text ranges\n- Always mock LLM in tests","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:24.976161-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:24.976161-07:00","dependencies":[{"issue_id":"sona-i0j","depends_on_id":"sona-9o6","type":"blocks","created_at":"2026-02-09T14:57:50.158467-07:00","created_by":"Ken Allred"},{"issue_id":"sona-i0j","depends_on_id":"sona-zuv","type":"blocks","created_at":"2026-02-09T14:57:55.387258-07:00","created_by":"Ken Allred"}]}
{"id":"sona-iu6","title":"Build Voice DNA display with structured fields and manual editing","description":"## Covers\nUS-016/021 (frontend) — DNA display on clone detail Voice DNA tab.\n\n## Acceptance Criteria\n- GIVEN Voice DNA tab WHEN DNA exists THEN shows structured display organized by 9 categories\n- GIVEN each category WHEN displayed THEN shows sub-fields (vocabulary: complexity, favorites, avoided, jargon, contractions, etc.)\n- GIVEN each field WHEN clicked THEN becomes editable (text fields inline, dropdowns for enums, tag inputs for arrays)\n- GIVEN a field WHEN edited and saved THEN creates new DNA version with trigger='manual_edit'\n- GIVEN no DNA WHEN tab shown THEN displays 'Analyze Voice DNA first' with action button\n- GIVEN the DNA display WHEN rendered THEN categories are collapsible accordions\n\n## Files to Create/Modify\n- frontend/src/components/clones/DnaDisplay.tsx (create)\n- frontend/src/components/clones/DnaCategorySection.tsx (create)\n- frontend/src/components/clones/DnaFieldEditor.tsx (create)\n- frontend/src/hooks/use-dna.ts (create)\n- frontend/src/components/clones/DnaDisplay.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_9_categories\n2. test_category_shows_sub_fields\n3. test_field_click_enables_edit\n4. test_save_edit_creates_version\n5. test_no_dna_shows_analyze_cta\n6. test_categories_collapsible\n\n## Gotchas\n- DNA structure is deeply nested — need recursive/mapped rendering\n- Manual edit only saves changed fields, but creates full snapshot version\n- Use shadcn/ui Accordion for collapsible sections","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:44:36.387719-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:44:36.387719-07:00","dependencies":[{"issue_id":"sona-iu6","depends_on_id":"sona-0ya","type":"blocks","created_at":"2026-02-09T14:56:26.592371-07:00","created_by":"Ken Allred"},{"issue_id":"sona-iu6","depends_on_id":"sona-0zz","type":"blocks","created_at":"2026-02-09T14:56:31.823564-07:00","created_by":"Ken Allred"}]}
{"id":"sona-jsa","title":"Create docs/coding-standards.md as definitive code quality reference","status":"closed","priority":1,"issue_type":"task","assignee":"Ken Allred","owner":"zigrivers@gmail.com","created_at":"2026-02-08T10:41:43.767452-07:00","created_by":"Ken Allred","updated_at":"2026-02-08T10:47:57.662768-07:00","closed_at":"2026-02-08T10:47:57.662768-07:00","close_reason":"Closed","dependencies":[{"issue_id":"sona-jsa","depends_on_id":"sona-8yj","type":"blocks","created_at":"2026-02-08T10:41:52.018392-07:00","created_by":"Ken Allred"}]}
{"id":"sona-lcw","title":"Implement real-time authenticity preview and content repurposing","description":"## Covers\nUS-050/051 — Live authenticity preview and cross-platform repurposing.\n\n## Acceptance Criteria\n- GIVEN content editor WHEN content is edited THEN authenticity score updates in near-real-time (debounced)\n- GIVEN content in library WHEN 'Repurpose' clicked THEN opens generator pre-populated with content for a different platform\n- GIVEN repurpose WHEN platform changed THEN regenerates optimized for new platform\n\n## Files to Create/Modify\n- frontend/src/hooks/use-realtime-score.ts (create — debounced scoring)\n- frontend/src/components/content/RepurposeButton.tsx (create)\n- frontend/src/hooks/use-realtime-score.test.ts (create)\n- frontend/src/components/content/RepurposeButton.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_debounced_scoring_on_edit\n2. test_repurpose_opens_generator\n3. test_repurpose_changes_platform\n\n## Gotchas\n- Debounce: 2-3 second delay after last keystroke\n- Real-time scoring is expensive — use sparingly\n- Repurpose creates new content, not modifies existing","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:47.116167-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:47.116167-07:00","dependencies":[{"issue_id":"sona-lcw","depends_on_id":"sona-9o6","type":"blocks","created_at":"2026-02-09T14:59:45.20391-07:00","created_by":"Ken Allred"},{"issue_id":"sona-lcw","depends_on_id":"sona-4g8","type":"blocks","created_at":"2026-02-09T14:59:50.432821-07:00","created_by":"Ken Allred"}]}
{"id":"sona-moc","title":"Create all SQLAlchemy models and initial Alembic migration","description":"## Covers\nUS-008/016/034 models — all database entities needed for Sona.\n\n## Acceptance Criteria\n- GIVEN alembic upgrade head WHEN run on empty database THEN all 9 tables are created with correct columns, FKs, and indexes\n- GIVEN alembic downgrade base WHEN run THEN all tables are dropped cleanly\n- GIVEN VoiceClone model WHEN instantiated THEN it has: id, name, description, tags (JSON), type (original/merged/demo), is_demo, is_hidden, avatar_path, created_at, updated_at\n- GIVEN WritingSample model WHEN instantiated THEN it has: id, clone_id (FK), content, content_type, content_type_detected, word_count, length_category, source_type, source_url, source_filename, created_at\n- GIVEN VoiceDNAVersion model WHEN instantiated THEN it has: id, clone_id (FK), version_number, data (JSON), prominence_scores (JSON), trigger, model_used, created_at\n- GIVEN Content model WHEN instantiated THEN it has: id, clone_id (FK), platform, status, content_current, content_original, input_text, generation_properties (JSON), authenticity_score, score_dimensions (JSON), topic, campaign, tags (JSON), word_count, char_count, preset_id (FK nullable), created_at, updated_at\n- GIVEN ContentVersion model WHEN instantiated THEN it has: id, content_id (FK), version_number, content_text, trigger, word_count, created_at\n- GIVEN MergedCloneSource model WHEN instantiated THEN it has: id, merged_clone_id (FK), source_clone_id (FK), weights (JSON)\n- GIVEN MethodologySettings model WHEN instantiated THEN it has: id, section_key (unique), current_content, created_at, updated_at\n- GIVEN MethodologyVersion model WHEN instantiated THEN it has: id, settings_id (FK), version_number, content, trigger, created_at\n- GIVEN GenerationPreset model WHEN instantiated THEN it has: id, name (unique), properties (JSON), created_at, updated_at\n- GIVEN all models WHEN relationships are accessed THEN loading strategies are explicitly specified (selectinload/joinedload)\n\n## Files to Create/Modify\n- backend/app/models/__init__.py (create)\n- backend/app/models/clone.py (create — VoiceClone, MergedCloneSource)\n- backend/app/models/sample.py (create — WritingSample)\n- backend/app/models/dna.py (create — VoiceDNAVersion)\n- backend/app/models/content.py (create — Content, ContentVersion)\n- backend/app/models/methodology.py (create — MethodologySettings, MethodologyVersion)\n- backend/app/models/preset.py (create — GenerationPreset)\n- backend/app/database.py (modify — add naming convention to Base.metadata)\n- backend/alembic/versions/ (create — single initial migration)\n\n## TDD Test Cases (Write First)\n1. test_voice_clone_create_with_required_fields\n2. test_voice_clone_relationships_load_samples\n3. test_writing_sample_belongs_to_clone\n4. test_content_has_version_history\n5. test_methodology_settings_unique_section_key\n6. test_merged_clone_source_links_clones\n7. test_migration_upgrade_creates_all_tables\n8. test_migration_downgrade_drops_all_tables\n\n## Gotchas\n- Use batch operations in Alembic migration for SQLite compatibility\n- nanoid for all primary keys (21-char URL-safe string)\n- JSON columns stored as sa.Text with Python-side serialization\n- All timestamps use UTC\n- expire_on_commit=False already set in database.py","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:36:37.977637-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:36:37.977637-07:00","dependencies":[{"issue_id":"sona-moc","depends_on_id":"sona-ega","type":"blocks","created_at":"2026-02-09T14:49:50.320286-07:00","created_by":"Ken Allred"}]}
{"id":"sona-mvk","title":"Create API router, shared dependencies, and exception handler","description":"## Covers\nInfrastructure — API routing and shared FastAPI dependencies.\n\n## Acceptance Criteria\n- GIVEN api/router.py WHEN imported THEN it provides a single api_router with /api prefix\n- GIVEN api/deps.py WHEN get_session is used THEN it yields an AsyncSession from the session factory\n- GIVEN api/deps.py WHEN get_llm_provider is used THEN it returns the default LLM provider from the registry\n- GIVEN the app WHEN any SonaError is raised THEN the global handler returns {detail, code} JSON with mapped HTTP status\n- GIVEN the app WHEN a non-SonaError is raised THEN it returns 500 with generic error message\n\n## Files to Create/Modify\n- backend/app/api/__init__.py (create)\n- backend/app/api/router.py (create — router composition)\n- backend/app/api/deps.py (create — get_session, get_llm_provider)\n- backend/app/main.py (modify — mount api_router, add exception handlers)\n\n## TDD Test Cases (Write First)\n1. test_health_endpoint_returns_ok\n2. test_api_router_prefix_is_api\n3. test_get_session_yields_async_session\n4. test_unknown_route_returns_404\n5. test_sona_error_handler_maps_status_codes\n\n## Gotchas\n- router.py is append-only — each domain adds include_router\n- deps.py provides get_llm_provider that raises ProviderNotConfiguredError when no provider is set","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:36:43.18936-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:36:43.18936-07:00","dependencies":[{"issue_id":"sona-mvk","depends_on_id":"sona-ega","type":"blocks","created_at":"2026-02-09T14:49:55.505563-07:00","created_by":"Ken Allred"}]}
{"id":"sona-n3h","title":"Implement soft-delete for clones with 30-day retention","description":"## Covers\nUS-056 — Soft-delete with recovery period.\n\n## Acceptance Criteria\n- GIVEN DELETE /api/clones/{id} WHEN soft-delete enabled THEN sets deleted_at timestamp instead of actual delete\n- GIVEN soft-deleted clone WHEN 30 days pass THEN permanently deleted by cleanup job\n- GIVEN soft-deleted clone WHEN within 30 days THEN can be restored via POST /api/clones/{id}/restore\n- GIVEN clone list WHEN loading THEN excludes soft-deleted clones by default\n\n## Files to Create/Modify\n- backend/app/models/clone.py (modify — add deleted_at column)\n- backend/app/services/clone_service.py (modify — soft-delete logic)\n- backend/app/api/clones.py (modify — add restore endpoint)\n- frontend/src/components/clones/DeletedClones.tsx (create)\n- backend/tests/test_services/test_clone_service.py (modify)\n\n## TDD Test Cases (Write First)\n1. test_soft_delete_sets_deleted_at\n2. test_soft_deleted_excluded_from_list\n3. test_restore_clears_deleted_at\n4. test_permanent_delete_after_30_days\n\n## Gotchas\n- Requires new Alembic migration for deleted_at column\n- Cleanup could be a background task or run on app start","status":"open","priority":3,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:48:36.700097-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:48:36.700097-07:00","dependencies":[{"issue_id":"sona-n3h","depends_on_id":"sona-8d7","type":"blocks","created_at":"2026-02-09T14:59:29.52881-07:00","created_by":"Ken Allred"},{"issue_id":"sona-n3h","depends_on_id":"sona-1a4","type":"blocks","created_at":"2026-02-09T14:59:34.755515-07:00","created_by":"Ken Allred"}]}
{"id":"sona-o8k","title":"Implement methodology settings backend with versioning","description":"## Covers\nUS-004 (backend) — Methodology settings CRUD with version history.\n\n## Acceptance Criteria\n- GIVEN GET /api/methodology/{section} WHEN section exists THEN returns current content and version count\n- GIVEN PUT /api/methodology/{section} with {content} WHEN content changed THEN creates new version, increments version number\n- GIVEN PUT /api/methodology/{section} WHEN content unchanged THEN returns 200 without creating new version\n- GIVEN GET /api/methodology/{section}/versions WHEN versions exist THEN returns last 10 versions ordered by version_number desc\n- GIVEN POST /api/methodology/{section}/revert/{version} WHEN version exists THEN creates new version with old content, trigger='revert'\n- GIVEN version count exceeds 10 WHEN new version created THEN oldest version is pruned\n- GIVEN section_key WHEN queried THEN valid values are: voice_cloning, authenticity, platform_practices\n\n## Files to Create/Modify\n- backend/app/services/methodology_service.py (create)\n- backend/app/api/methodology.py (create)\n- backend/app/api/router.py (modify — add methodology router)\n- backend/tests/test_services/test_methodology_service.py (create)\n- backend/tests/test_api/test_methodology.py (create)\n\n## TDD Test Cases (Write First)\n1. test_get_methodology_section\n2. test_update_creates_new_version\n3. test_update_unchanged_content_no_new_version\n4. test_list_versions_returns_last_10\n5. test_revert_creates_new_version_with_old_content\n6. test_prune_oldest_version_when_exceeds_10\n7. test_invalid_section_key_returns_404\n\n## Gotchas\n- Three sections seeded on first run (task 16)\n- Revert creates a NEW version (non-destructive)\n- Version pruning: delete oldest when count \u003e MAX_METHODOLOGY_VERSIONS","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:39:48.300526-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:39:48.300526-07:00","dependencies":[{"issue_id":"sona-o8k","depends_on_id":"sona-moc","type":"blocks","created_at":"2026-02-09T14:51:02.964745-07:00","created_by":"Ken Allred"},{"issue_id":"sona-o8k","depends_on_id":"sona-mvk","type":"blocks","created_at":"2026-02-09T14:51:08.190569-07:00","created_by":"Ken Allred"},{"issue_id":"sona-o8k","depends_on_id":"sona-cco","type":"blocks","created_at":"2026-02-09T14:51:13.417619-07:00","created_by":"Ken Allred"}]}
{"id":"sona-oi8","title":"Implement Anthropic LLM provider","description":"## Covers\nUS-001 (Anthropic) — Anthropic provider implementation.\n\n## Acceptance Criteria\n- GIVEN AnthropicProvider WHEN complete() is called THEN it calls anthropic.AsyncAnthropic.messages.create and returns the text content\n- GIVEN AnthropicProvider WHEN stream() is called THEN it yields chunks from Anthropic streaming response\n- GIVEN AnthropicProvider WHEN test_connection() is called THEN it sends a minimal API call and returns True on success\n- GIVEN an anthropic.AuthenticationError WHEN caught THEN it raises LLMAuthError\n- GIVEN an anthropic.RateLimitError WHEN caught THEN it raises LLMRateLimitError\n\n## Files to Create/Modify\n- backend/app/llm/anthropic.py (create)\n\n## TDD Test Cases (Write First)\n1. test_complete_returns_response_text\n2. test_stream_yields_chunks\n3. test_test_connection_returns_true\n4. test_auth_error_maps_correctly\n5. test_rate_limit_maps_correctly\n\n## Gotchas\n- Anthropic uses messages API, not completions\n- Token counting: approximate (1 token ≈ 4 chars) — no official tokenizer package","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:37:04.033577-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:37:04.033577-07:00","dependencies":[{"issue_id":"sona-oi8","depends_on_id":"sona-535","type":"blocks","created_at":"2026-02-09T14:50:16.256923-07:00","created_by":"Ken Allred"}]}
{"id":"sona-onf","title":"Implement Voice DNA analysis orchestration with LLM","description":"## Covers\nUS-016/017 (backend) — DNA analysis orchestration and versioning.\n\n## Acceptance Criteria\n- GIVEN POST /api/clones/{id}/analyze WHEN clone has samples THEN sends all samples + methodology instructions to LLM\n- GIVEN POST /api/clones/{id}/analyze WHEN analysis succeeds THEN creates a new VoiceDNAVersion with: full DNA JSON, prominence_scores, trigger='initial_analysis' or 'regeneration', model_used\n- GIVEN POST /api/clones/{id}/analyze WHEN clone has no samples THEN returns 400 with 'Clone has no writing samples'\n- GIVEN POST /api/clones/{id}/analyze WHEN LLM fails THEN returns 502 with AnalysisFailedError\n- GIVEN GET /api/clones/{id}/dna WHEN DNA exists THEN returns current (latest) DNA version\n- GIVEN GET /api/clones/{id}/dna WHEN no DNA exists THEN returns 404\n- GIVEN GET /api/clones/{id}/dna/versions WHEN versions exist THEN returns list ordered by version_number desc\n- GIVEN DNA analysis WHEN returned JSON THEN it contains all 9 categories: vocabulary, sentence_structure, paragraph_structure, tone, rhetorical_devices, punctuation, openings_and_closings, humor, signatures\n- GIVEN DNA analysis WHEN returned JSON THEN prominence_scores maps each category to 0-100\n\n## Files to Create/Modify\n- backend/app/services/dna_service.py (create)\n- backend/app/api/clones.py (modify — add analyze endpoint)\n- backend/tests/test_services/test_dna_service.py (create)\n- backend/tests/test_api/test_dna.py (create)\n\n## TDD Test Cases (Write First)\n1. test_analyze_creates_dna_version\n2. test_analyze_no_samples_returns_error\n3. test_analyze_sends_all_samples_to_llm\n4. test_analyze_includes_methodology_instructions\n5. test_analyze_parses_llm_json_response\n6. test_analyze_sets_trigger_correctly\n7. test_get_current_dna\n8. test_get_dna_not_found\n9. test_list_dna_versions\n\n## Gotchas\n- LLM must be mocked in all tests\n- DNA JSON is complex — validate structure after parsing\n- prominence_scores must have exactly 9 entries\n- Use methodology voice_cloning section as analysis framework","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:09.222479-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:09.222479-07:00","dependencies":[{"issue_id":"sona-onf","depends_on_id":"sona-moc","type":"blocks","created_at":"2026-02-09T14:51:44.742457-07:00","created_by":"Ken Allred"},{"issue_id":"sona-onf","depends_on_id":"sona-535","type":"blocks","created_at":"2026-02-09T14:51:49.968393-07:00","created_by":"Ken Allred"},{"issue_id":"sona-onf","depends_on_id":"sona-dfe","type":"blocks","created_at":"2026-02-09T14:51:55.105453-07:00","created_by":"Ken Allred"}]}
{"id":"sona-osv","title":"Build export functionality: copy, txt, PDF, multi-item","description":"## Covers\nUS-040 — Content export options.\n\n## Acceptance Criteria\n- GIVEN content detail WHEN 'Copy' clicked THEN copies platform-formatted content to clipboard with success toast\n- GIVEN content detail WHEN 'Export as Text' clicked THEN downloads .txt file\n- GIVEN content detail WHEN 'Export as PDF' clicked THEN generates and downloads PDF via jspdf\n- GIVEN library WHEN multiple items selected and 'Export' clicked THEN generates single document with all items separated\n- GIVEN multi-item export WHEN format chosen THEN supports both .txt and .pdf\n\n## Files to Create/Modify\n- frontend/src/components/content/ExportMenu.tsx (create)\n- frontend/src/lib/export.ts (create — export utility functions)\n- frontend/src/components/content/ExportMenu.test.tsx (create)\n- frontend/src/lib/export.test.ts (create)\n\n## TDD Test Cases (Write First)\n1. test_copy_to_clipboard\n2. test_export_as_txt\n3. test_export_as_pdf\n4. test_multi_item_export_txt\n5. test_multi_item_export_pdf\n\n## Gotchas\n- Use navigator.clipboard.writeText for copy\n- jspdf for PDF generation (client-side)\n- File download via blob URL + anchor click","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:45:02.613928-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:45:02.613928-07:00","dependencies":[{"issue_id":"sona-osv","depends_on_id":"sona-4g8","type":"blocks","created_at":"2026-02-09T14:57:03.099256-07:00","created_by":"Ken Allred"}]}
{"id":"sona-r64","title":"Build clone comparison view with overlaid radar charts","description":"## Covers\nUS-041 — Side-by-side clone comparison.\n\n## Acceptance Criteria\n- GIVEN /clones/compare?a={id}\u0026b={id} WHEN both clones have DNA THEN shows overlaid radar charts\n- GIVEN comparison WHEN rendered THEN shows: two overlaid charts with different colors, clone names with color legend\n- GIVEN dimension table WHEN shown THEN lists: dimension name, Clone A summary, Clone B summary, difference indicator\n- GIVEN difference indicator WHEN scores within 15 THEN shows 'Similar'\n- GIVEN difference indicator WHEN scores 15-40 apart THEN shows 'Different'\n- GIVEN difference indicator WHEN scores 40+ apart THEN shows 'Very Different'\n- GIVEN a clone without DNA WHEN comparison attempted THEN shows 'Analyze DNA first' message\n\n## Files to Create/Modify\n- frontend/src/pages/clones/ComparePage.tsx (create)\n- frontend/src/components/clones/ComparisonChart.tsx (create)\n- frontend/src/components/clones/DimensionTable.tsx (create)\n- frontend/src/pages/clones/ComparePage.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_overlaid_radar_charts\n2. test_color_legend\n3. test_dimension_table_differences\n4. test_similar_indicator\n5. test_different_indicator\n6. test_very_different_indicator\n7. test_clone_without_dna_message\n\n## Gotchas\n- URL-based (bookmarkable): /clones/compare?a={id}\u0026b={id}\n- Recharts supports multiple data series on one RadarChart\n- Access from clone list when 2 clones selected via checkboxes","status":"open","priority":2,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:46:40.62255-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:46:40.62255-07:00","dependencies":[{"issue_id":"sona-r64","depends_on_id":"sona-dxa","type":"blocks","created_at":"2026-02-09T14:58:16.321307-07:00","created_by":"Ken Allred"}]}
{"id":"sona-s1r","title":"Implement merge orchestration backend and merged clone behavior","description":"## Covers\nUS-043/044 — Backend merge logic and merged clone rules.\n\n## Acceptance Criteria\n- GIVEN POST /api/clones/merge with {source_clone_ids, weights, name} WHEN valid THEN sends all source DNAs + weight matrix to LLM\n- GIVEN merge succeeds WHEN new clone created THEN type='merged', DNA version 1 stored, MergedCloneSource records created\n- GIVEN merged clone WHEN used for generation THEN works identically to original clones\n- GIVEN merged clone WHEN further merged THEN allowed (merged into merged)\n- GIVEN merged clone WHEN samples added THEN returns 400 (samples come from sources)\n- GIVEN source clone deleted WHEN merged clone viewed THEN source lineage shows '[Deleted clone]'\n- GIVEN merge fails (LLM error) WHEN error returned THEN no clone is created\n\n## Files to Create/Modify\n- backend/app/services/merge_service.py (create)\n- backend/app/api/clones.py (modify — add merge endpoint)\n- backend/tests/test_services/test_merge_service.py (create)\n- backend/tests/test_api/test_merge.py (create)\n\n## TDD Test Cases (Write First)\n1. test_merge_creates_new_clone\n2. test_merge_stores_source_lineage\n3. test_merge_sends_dna_and_weights_to_llm\n4. test_merged_clone_type_is_merged\n5. test_merged_clone_rejects_samples\n6. test_source_deletion_shows_deleted_label\n7. test_merge_failure_no_clone_created\n\n## Gotchas\n- LLM always mocked in tests\n- Weight matrix: JSON mapping {element: {source_id: weight}}\n- Merge prompt in llm/prompts.py","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:45:13.10689-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:45:13.10689-07:00","dependencies":[{"issue_id":"sona-s1r","depends_on_id":"sona-onf","type":"blocks","created_at":"2026-02-09T14:57:18.797419-07:00","created_by":"Ken Allred"},{"issue_id":"sona-s1r","depends_on_id":"sona-y2z","type":"blocks","created_at":"2026-02-09T14:57:24.02301-07:00","created_by":"Ken Allred"}]}
{"id":"sona-syp","title":"Build methodology settings editor UI with tabs and version history","description":"## Covers\nUS-004 (frontend) — Methodology editor with 3 tabs and version history.\n\n## Acceptance Criteria\n- GIVEN /settings/methodology WHEN loaded THEN shows 3 tabs: Voice Cloning Instructions, Authenticity Guidelines, Platform Best Practices\n- GIVEN a tab WHEN selected THEN shows current content in an editable textarea\n- GIVEN content is edited WHEN Save clicked THEN saves and shows success toast\n- GIVEN no changes made WHEN Save clicked THEN button is disabled\n- GIVEN 'Version History' WHEN clicked THEN shows list of versions with: version number, timestamp, trigger type\n- GIVEN a version in history WHEN 'Revert' clicked THEN confirms and reverts to that version\n\n## Files to Create/Modify\n- frontend/src/pages/settings/MethodologyPage.tsx (create)\n- frontend/src/components/settings/MethodologyEditor.tsx (create)\n- frontend/src/components/settings/VersionHistory.tsx (create — reusable for DNA versions too)\n- frontend/src/hooks/use-methodology.ts (create)\n- frontend/src/test/handlers/methodology.ts (modify)\n- frontend/src/pages/settings/MethodologyPage.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_renders_three_tabs\n2. test_tab_switch_loads_content\n3. test_save_disabled_when_unchanged\n4. test_save_creates_new_version\n5. test_version_history_shows_versions\n6. test_revert_confirms_and_reverts\n\n## Gotchas\n- Textarea should be large (min-h-96)\n- Content is markdown — no rich editor needed for v1\n- VersionHistory component will be reused for DNA and content versions","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:42:40.54778-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:42:40.54778-07:00","dependencies":[{"issue_id":"sona-syp","depends_on_id":"sona-bf7","type":"blocks","created_at":"2026-02-09T14:53:34.193129-07:00","created_by":"Ken Allred"},{"issue_id":"sona-syp","depends_on_id":"sona-w7n","type":"blocks","created_at":"2026-02-09T14:53:39.418373-07:00","created_by":"Ken Allred"},{"issue_id":"sona-syp","depends_on_id":"sona-fhi","type":"blocks","created_at":"2026-02-09T14:53:44.646198-07:00","created_by":"Ken Allred"},{"issue_id":"sona-syp","depends_on_id":"sona-ad6","type":"blocks","created_at":"2026-02-09T14:53:49.869711-07:00","created_by":"Ken Allred"},{"issue_id":"sona-syp","depends_on_id":"sona-o8k","type":"blocks","created_at":"2026-02-09T14:53:55.101828-07:00","created_by":"Ken Allred"}]}
{"id":"sona-szg","title":"Implement provider configuration backend with .env key management","description":"## Covers\nUS-002/003 (backend) — Provider config API and connection testing.\n\n## Acceptance Criteria\n- GIVEN GET /api/providers WHEN called THEN returns list of 3 providers with status and masked keys\n- GIVEN PUT /api/providers/{name} with {api_key, model} WHEN valid THEN writes key to .env and returns masked key\n- GIVEN PUT /api/providers/{name} WHEN key is saved THEN connection test runs automatically\n- GIVEN POST /api/providers/{name}/test WHEN key is valid THEN returns {status: 'connected'}\n- GIVEN POST /api/providers/{name}/test WHEN key is invalid THEN returns {status: 'error', error_type: 'auth', error_message: '...'}\n- GIVEN POST /api/providers/{name}/test WHEN rate limited THEN returns {status: 'error', error_type: 'rate_limit'}\n- GIVEN PUT /api/providers/default with {name} WHEN provider is connected THEN sets DEFAULT_LLM_PROVIDER in .env\n- GIVEN masked key WHEN returned to frontend THEN only last 4 chars are visible\n\n## Files to Create/Modify\n- backend/app/services/provider_service.py (create)\n- backend/app/api/providers.py (create)\n- backend/app/api/router.py (modify — add providers router)\n- backend/tests/test_services/test_provider_service.py (create)\n- backend/tests/test_api/test_providers.py (create)\n\n## TDD Test Cases (Write First)\n1. test_list_providers_returns_three\n2. test_save_provider_writes_env\n3. test_save_provider_returns_masked_key\n4. test_test_connection_success\n5. test_test_connection_auth_failure\n6. test_test_connection_rate_limit\n7. test_set_default_provider\n8. test_mask_key_shows_last_4\n\n## Gotchas\n- Writing .env requires careful file I/O — read, parse, update, write\n- Never return full API key after save — only masked\n- Connection test delegates to LLMProvider.test_connection()","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:39:58.817131-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:39:58.817131-07:00","dependencies":[{"issue_id":"sona-szg","depends_on_id":"sona-mvk","type":"blocks","created_at":"2026-02-09T14:51:23.859322-07:00","created_by":"Ken Allred"},{"issue_id":"sona-szg","depends_on_id":"sona-535","type":"blocks","created_at":"2026-02-09T14:51:29.098678-07:00","created_by":"Ken Allred"}]}
{"id":"sona-tw8","title":"Build confidence score display with breakdown and recommendations","description":"## Covers\nUS-013/021 (frontend) — Confidence score visualization and recommendations.\n\n## Acceptance Criteria\n- GIVEN a clone WHEN confidence score displayed THEN shows colored badge: green (80+), yellow (60-79), red (\u003c60)\n- GIVEN confidence breakdown WHEN displayed THEN shows 5 components with individual scores and max values\n- GIVEN score below 80 WHEN recommendations shown THEN displays specific suggestions based on missing components\n- GIVEN 'Ready for use' threshold WHEN score \u003e= 80 THEN shows green badge with 'Ready for use'\n- GIVEN low word count WHEN recommendation shown THEN suggests 'Add more writing samples...'\n\n## Files to Create/Modify\n- frontend/src/components/clones/ConfidenceBadge.tsx (create)\n- frontend/src/components/samples/ConfidenceBreakdown.tsx (modify — add recommendations)\n- frontend/src/components/clones/ConfidenceBadge.test.tsx (create)\n- frontend/src/components/samples/ConfidenceBreakdown.test.tsx (modify)\n\n## TDD Test Cases (Write First)\n1. test_badge_green_at_80_plus\n2. test_badge_yellow_at_60_to_79\n3. test_badge_red_below_60\n4. test_breakdown_shows_all_components\n5. test_recommendations_for_low_word_count\n6. test_recommendations_for_low_variety\n7. test_no_recommendations_at_80_plus\n\n## Gotchas\n- Badge component is reusable — used in clone list, clone detail header, clone selector\n- Recommendations text matches PRD exactly","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:43:06.780786-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:43:06.780786-07:00","dependencies":[{"issue_id":"sona-tw8","depends_on_id":"sona-0ya","type":"blocks","created_at":"2026-02-09T14:54:52.51671-07:00","created_by":"Ken Allred"},{"issue_id":"sona-tw8","depends_on_id":"sona-879","type":"blocks","created_at":"2026-02-09T14:54:57.744651-07:00","created_by":"Ken Allred"}]}
{"id":"sona-vip","title":"Build DNA version history sidebar with preview and revert","description":"## Covers\nUS-019 (frontend) — DNA version history navigation.\n\n## Acceptance Criteria\n- GIVEN Voice DNA tab WHEN version history sidebar shown THEN lists last 10 versions\n- GIVEN each version WHEN displayed THEN shows: version number, timestamp, trigger type badge, model used\n- GIVEN a version WHEN clicked THEN shows read-only preview of that version's DNA\n- GIVEN a version WHEN 'Revert' clicked THEN confirms and reverts (creates new version)\n- GIVEN current version WHEN in list THEN highlighted and revert button hidden\n\n## Files to Create/Modify\n- frontend/src/components/shared/VersionHistory.tsx (modify — make generic for DNA and content)\n- frontend/src/components/clones/DnaVersionSidebar.tsx (create)\n- frontend/src/components/clones/DnaVersionSidebar.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_shows_version_list\n2. test_version_shows_trigger_badge\n3. test_click_shows_preview\n4. test_revert_confirmation\n5. test_current_version_highlighted\n\n## Gotchas\n- Reuse VersionHistory component (also used for content versions and methodology)\n- Trigger badges: initial_analysis, regeneration, manual_edit, revert\n- Preview is read-only — no edit capability","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:44:41.634365-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:44:41.634365-07:00","dependencies":[{"issue_id":"sona-vip","depends_on_id":"sona-iu6","type":"blocks","created_at":"2026-02-09T14:56:37.049301-07:00","created_by":"Ken Allred"}]}
{"id":"sona-w7n","title":"Create frontend API client, query keys, and QueryClientProvider","description":"## Covers\nInfrastructure — frontend data fetching layer.\n\n## Acceptance Criteria\n- GIVEN lib/api.ts WHEN api.get('/api/clones') is called THEN it sends a GET request and returns parsed JSON\n- GIVEN lib/api.ts WHEN the API returns an error THEN it throws an ApiError with {detail, code} shape\n- GIVEN lib/api.ts WHEN api.post is called with a body THEN it sends JSON content-type\n- GIVEN lib/query-keys.ts WHEN queryKeys.clones.list() is called THEN it returns ['clones', 'list', undefined]\n- GIVEN lib/query-keys.ts WHEN queryKeys.clones.detail('abc') is called THEN it returns ['clones', 'detail', 'abc']\n- GIVEN the App WHEN it renders THEN all components have access to QueryClient via QueryClientProvider\n- GIVEN QueryClient WHEN configured THEN default staleTime is set and retry is configured\n\n## Files to Create/Modify\n- frontend/src/lib/api.ts (create — ApiClient class with get/post/put/delete)\n- frontend/src/lib/query-keys.ts (create — query key factory)\n- frontend/src/App.tsx (modify — wrap with QueryClientProvider)\n- frontend/src/types/errors.ts (create — ApiError type)\n\n## TDD Test Cases (Write First)\n1. test_api_get_returns_parsed_json\n2. test_api_get_throws_api_error_on_failure\n3. test_api_post_sends_json_body\n4. test_api_delete_returns_void\n5. test_query_keys_clones_list\n6. test_query_keys_clones_detail\n7. test_query_keys_content_list\n\n## Gotchas\n- API client uses native fetch (no axios)\n- Base URL is empty string (Vite proxy handles /api)\n- query-keys.ts is append-only — each domain adds its keys","status":"open","priority":0,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:37:19.673566-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:37:19.673566-07:00"}
{"id":"sona-y2z","title":"Build merge UI with source selection and per-element weight controls","description":"## Covers\nUS-042 — Voice merge interface.\n\n## Acceptance Criteria\n- GIVEN /clones/merge WHEN loaded THEN shows: source clone multi-select (2-5), weight controls, merge button\n- GIVEN source selector WHEN expanded THEN shows searchable list of clones with DNA (clones without DNA disabled)\n- GIVEN 2+ clones selected WHEN weight panel shown THEN each clone has 9 element sliders (0-100%)\n- GIVEN weight sliders WHEN adjusted THEN weights are relative (shown as percentage of total)\n- GIVEN all weights at 0 for an element THEN treated as equal distribution\n- GIVEN merged clone name WHEN entered and 'Create Merged Clone' clicked THEN triggers merge\n- GIVEN fewer than 2 clones WHEN selected THEN merge button disabled\n\n## Files to Create/Modify\n- frontend/src/pages/clones/MergePage.tsx (create)\n- frontend/src/components/merge/SourceSelector.tsx (create)\n- frontend/src/components/merge/WeightControls.tsx (create)\n- frontend/src/components/merge/WeightMatrix.tsx (create)\n- frontend/src/hooks/use-merge.ts (create)\n- frontend/src/pages/clones/MergePage.test.tsx (create)\n\n## TDD Test Cases (Write First)\n1. test_source_selector_shows_clones_with_dna\n2. test_disabled_clones_without_dna\n3. test_weight_sliders_for_9_elements\n4. test_weights_relative_display\n5. test_merge_disabled_under_2_clones\n6. test_merge_submits_with_weights\n\n## Gotchas\n- 9 mergeable elements match DNA categories\n- Weight matrix visualization: grid of sliders\n- 'Experimental' badge on the merge page","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:45:07.868627-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:45:07.868627-07:00","dependencies":[{"issue_id":"sona-y2z","depends_on_id":"sona-1a4","type":"blocks","created_at":"2026-02-09T14:57:08.333223-07:00","created_by":"Ken Allred"},{"issue_id":"sona-y2z","depends_on_id":"sona-dxa","type":"blocks","created_at":"2026-02-09T14:57:13.57174-07:00","created_by":"Ken Allred"}]}
{"id":"sona-zuv","title":"Implement 8-dimension authenticity scoring backend","description":"## Covers\nUS-030 (backend) — Authenticity scoring via LLM evaluation.\n\n## Acceptance Criteria\n- GIVEN POST /api/content/{id}/score WHEN content and clone DNA exist THEN LLM evaluates content across 8 dimensions\n- GIVEN scoring results WHEN returned THEN overall score = unweighted average of 8 dimension scores (rounded to int)\n- GIVEN 8 dimensions WHEN scored THEN they are: vocabulary_match, sentence_flow, structural_rhythm, tone_fidelity, rhetorical_fingerprint, punctuation_signature, hook_and_close, voice_personality\n- GIVEN each dimension WHEN scored below 70 THEN actionable feedback is provided with specific examples\n- GIVEN scoring prompt WHEN constructed THEN it includes: generated content, Voice DNA JSON, authenticity guidelines\n- GIVEN no provider configured WHEN score called THEN returns ProviderNotConfiguredError\n\n## Files to Create/Modify\n- backend/app/services/scoring_service.py (modify — add AuthenticityScorer)\n- backend/app/api/content.py (modify — add score endpoint)\n- backend/tests/test_services/test_scoring_service.py (modify — add authenticity tests)\n- backend/tests/test_api/test_content.py (modify — add score endpoint tests)\n\n## TDD Test Cases (Write First)\n1. test_score_returns_8_dimensions\n2. test_overall_score_is_average\n3. test_dimension_below_70_has_feedback\n4. test_scoring_prompt_includes_dna\n5. test_scoring_prompt_includes_guidelines\n6. test_score_without_provider_raises_error\n\n## Gotchas\n- Always mock LLM in tests\n- Score is stored on Content model (authenticity_score + score_dimensions JSON)\n- Dimensions map to specific DNA source fields per PRD table","status":"open","priority":1,"issue_type":"task","owner":"zigrivers@gmail.com","created_at":"2026-02-09T14:40:35.485733-07:00","created_by":"Ken Allred","updated_at":"2026-02-09T14:40:35.485733-07:00","dependencies":[{"issue_id":"sona-zuv","depends_on_id":"sona-d29","type":"blocks","created_at":"2026-02-09T14:52:42.030667-07:00","created_by":"Ken Allred"},{"issue_id":"sona-zuv","depends_on_id":"sona-535","type":"blocks","created_at":"2026-02-09T14:52:47.263084-07:00","created_by":"Ken Allred"}]}
